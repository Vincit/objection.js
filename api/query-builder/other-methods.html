<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Other Methods | Objection.js</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="An SQL friendly ORM for node.js">
    
    <link rel="preload" href="/objection.js/assets/css/0.styles.3da53256.css" as="style"><link rel="preload" href="/objection.js/assets/js/app.aac9f1d1.js" as="script"><link rel="preload" href="/objection.js/assets/js/2.95f20b73.js" as="script"><link rel="preload" href="/objection.js/assets/js/1.317fd1a4.js" as="script"><link rel="preload" href="/objection.js/assets/js/40.1106236d.js" as="script"><link rel="prefetch" href="/objection.js/assets/js/10.8a0f09eb.js"><link rel="prefetch" href="/objection.js/assets/js/11.bbb59564.js"><link rel="prefetch" href="/objection.js/assets/js/14.bb8bba7c.js"><link rel="prefetch" href="/objection.js/assets/js/15.bc71fa15.js"><link rel="prefetch" href="/objection.js/assets/js/16.1015d7dd.js"><link rel="prefetch" href="/objection.js/assets/js/17.ab0dd903.js"><link rel="prefetch" href="/objection.js/assets/js/18.a3b06a8a.js"><link rel="prefetch" href="/objection.js/assets/js/19.5c3531e2.js"><link rel="prefetch" href="/objection.js/assets/js/20.2af5813f.js"><link rel="prefetch" href="/objection.js/assets/js/21.6a6c2510.js"><link rel="prefetch" href="/objection.js/assets/js/22.eee14584.js"><link rel="prefetch" href="/objection.js/assets/js/23.6778d240.js"><link rel="prefetch" href="/objection.js/assets/js/24.c29fb8d5.js"><link rel="prefetch" href="/objection.js/assets/js/25.b88ad4e1.js"><link rel="prefetch" href="/objection.js/assets/js/26.9731c624.js"><link rel="prefetch" href="/objection.js/assets/js/27.2309824e.js"><link rel="prefetch" href="/objection.js/assets/js/28.9cd4116c.js"><link rel="prefetch" href="/objection.js/assets/js/29.9bc7197a.js"><link rel="prefetch" href="/objection.js/assets/js/3.67dbd821.js"><link rel="prefetch" href="/objection.js/assets/js/30.1547f4b8.js"><link rel="prefetch" href="/objection.js/assets/js/31.b88bc1d1.js"><link rel="prefetch" href="/objection.js/assets/js/32.66fe2719.js"><link rel="prefetch" href="/objection.js/assets/js/33.e8009bdb.js"><link rel="prefetch" href="/objection.js/assets/js/34.f1f78902.js"><link rel="prefetch" href="/objection.js/assets/js/35.207a938f.js"><link rel="prefetch" href="/objection.js/assets/js/36.b95f3f00.js"><link rel="prefetch" href="/objection.js/assets/js/37.4f09d1c0.js"><link rel="prefetch" href="/objection.js/assets/js/38.95ee9973.js"><link rel="prefetch" href="/objection.js/assets/js/39.5d0d1076.js"><link rel="prefetch" href="/objection.js/assets/js/4.45d2dbd6.js"><link rel="prefetch" href="/objection.js/assets/js/41.2819fb93.js"><link rel="prefetch" href="/objection.js/assets/js/42.46aedc9e.js"><link rel="prefetch" href="/objection.js/assets/js/43.97f8a0cf.js"><link rel="prefetch" href="/objection.js/assets/js/44.108db8aa.js"><link rel="prefetch" href="/objection.js/assets/js/45.0b550365.js"><link rel="prefetch" href="/objection.js/assets/js/46.7926c441.js"><link rel="prefetch" href="/objection.js/assets/js/47.2eb7ded0.js"><link rel="prefetch" href="/objection.js/assets/js/48.f94e2444.js"><link rel="prefetch" href="/objection.js/assets/js/49.a31c4e2f.js"><link rel="prefetch" href="/objection.js/assets/js/5.4784c48b.js"><link rel="prefetch" href="/objection.js/assets/js/50.e7cbb678.js"><link rel="prefetch" href="/objection.js/assets/js/51.9cce1f3f.js"><link rel="prefetch" href="/objection.js/assets/js/52.640685d3.js"><link rel="prefetch" href="/objection.js/assets/js/53.5926f518.js"><link rel="prefetch" href="/objection.js/assets/js/54.672b4e20.js"><link rel="prefetch" href="/objection.js/assets/js/55.2684a066.js"><link rel="prefetch" href="/objection.js/assets/js/56.28c3b1d4.js"><link rel="prefetch" href="/objection.js/assets/js/57.d32a8c76.js"><link rel="prefetch" href="/objection.js/assets/js/58.7ef64bdc.js"><link rel="prefetch" href="/objection.js/assets/js/59.57d27807.js"><link rel="prefetch" href="/objection.js/assets/js/6.d162f3c7.js"><link rel="prefetch" href="/objection.js/assets/js/60.fa4c2ff7.js"><link rel="prefetch" href="/objection.js/assets/js/61.03e12088.js"><link rel="prefetch" href="/objection.js/assets/js/62.9237edcc.js"><link rel="prefetch" href="/objection.js/assets/js/63.7f748604.js"><link rel="prefetch" href="/objection.js/assets/js/64.309afa4e.js"><link rel="prefetch" href="/objection.js/assets/js/65.5408ec5a.js"><link rel="prefetch" href="/objection.js/assets/js/66.255018e8.js"><link rel="prefetch" href="/objection.js/assets/js/67.8fe54358.js"><link rel="prefetch" href="/objection.js/assets/js/68.2f58527c.js"><link rel="prefetch" href="/objection.js/assets/js/69.1be647c6.js"><link rel="prefetch" href="/objection.js/assets/js/7.a905ae32.js"><link rel="prefetch" href="/objection.js/assets/js/70.499b7621.js"><link rel="prefetch" href="/objection.js/assets/js/71.1caae563.js"><link rel="prefetch" href="/objection.js/assets/js/72.9fe3e8ea.js"><link rel="prefetch" href="/objection.js/assets/js/73.adc7a66e.js"><link rel="prefetch" href="/objection.js/assets/js/74.051786cd.js"><link rel="prefetch" href="/objection.js/assets/js/75.3f83663e.js"><link rel="prefetch" href="/objection.js/assets/js/8.e75082ac.js"><link rel="prefetch" href="/objection.js/assets/js/9.0594e08f.js"><link rel="prefetch" href="/objection.js/assets/js/vendors~docsearch.08d45e08.js">
    <link rel="stylesheet" href="/objection.js/assets/css/0.styles.3da53256.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/objection.js/" class="home-link router-link-active"><!----> <span class="site-name">Objection.js</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/objection.js/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API Reference" class="dropdown-title"><span class="title">API Reference</span> <span class="arrow down"></span></button> <button type="button" aria-label="API Reference" class="mobile-dropdown-title"><span class="title">API Reference</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/api/objection/" class="nav-link">
  Main Module
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/query-builder/" class="nav-link router-link-active">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/model/" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/types/" class="nav-link">
  Types
</a></li></ul></div></div><div class="nav-item"><a href="/objection.js/recipes/" class="nav-link">
  Recipe Book
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Release Notes" class="dropdown-title"><span class="title">Release Notes</span> <span class="arrow down"></span></button> <button type="button" aria-label="Release Notes" class="mobile-dropdown-title"><span class="title">Release Notes</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/changelog.html" class="nav-link">
  Changelog
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/migration.html" class="nav-link">
  Migration to 3.0
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Vincit/objection.js/tree/v2/doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v2.x documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Vincit/objection.js/tree/v1/doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ‚≠ê Star
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/objection.js/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API Reference" class="dropdown-title"><span class="title">API Reference</span> <span class="arrow down"></span></button> <button type="button" aria-label="API Reference" class="mobile-dropdown-title"><span class="title">API Reference</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/api/objection/" class="nav-link">
  Main Module
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/query-builder/" class="nav-link router-link-active">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/model/" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/types/" class="nav-link">
  Types
</a></li></ul></div></div><div class="nav-item"><a href="/objection.js/recipes/" class="nav-link">
  Recipe Book
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Release Notes" class="dropdown-title"><span class="title">Release Notes</span> <span class="arrow down"></span></button> <button type="button" aria-label="Release Notes" class="mobile-dropdown-title"><span class="title">Release Notes</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/changelog.html" class="nav-link">
  Changelog
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/migration.html" class="nav-link">
  Migration to 3.0
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Vincit/objection.js/tree/v2/doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v2.x documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Vincit/objection.js/tree/v1/doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ‚≠ê Star
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Query Builder API Reference</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/objection.js/api/query-builder/find-methods.html" class="sidebar-link">Find Methods</a></li><li><a href="/objection.js/api/query-builder/mutate-methods.html" class="sidebar-link">Mutating Methods</a></li><li><a href="/objection.js/api/query-builder/eager-methods.html" class="sidebar-link">Eager Loading Methods</a></li><li><a href="/objection.js/api/query-builder/join-methods.html" class="sidebar-link">Join Methods</a></li><li><a href="/objection.js/api/query-builder/other-methods.html" aria-current="page" class="active sidebar-link">Other Methods</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#debug" class="sidebar-link">debug()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#toknexquery" class="sidebar-link">toKnexQuery()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#for" class="sidebar-link">for()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#context" class="sidebar-link">context()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#clearcontext" class="sidebar-link">clearContext()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#tablenamefor" class="sidebar-link">tableNameFor()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#tablereffor" class="sidebar-link">tableRefFor()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#reject" class="sidebar-link">reject()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#resolve" class="sidebar-link">resolve()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#isexecutable" class="sidebar-link">isExecutable()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#isfind" class="sidebar-link">isFind()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#isinsert" class="sidebar-link">isInsert()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#isupdate" class="sidebar-link">isUpdate()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#isdelete" class="sidebar-link">isDelete()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#isrelate" class="sidebar-link">isRelate()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#isunrelate" class="sidebar-link">isUnrelate()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#isinternal" class="sidebar-link">isInternal()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#haswheres" class="sidebar-link">hasWheres()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#hasselects" class="sidebar-link">hasSelects()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#haswithgraph" class="sidebar-link">hasWithGraph()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#has" class="sidebar-link">has()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#clear" class="sidebar-link">clear()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#runbefore" class="sidebar-link">runBefore()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#onbuild" class="sidebar-link">onBuild()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#onbuildknex" class="sidebar-link">onBuildKnex()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#runafter" class="sidebar-link">runAfter()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#onerror" class="sidebar-link">onError()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#castto" class="sidebar-link">castTo()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#modelclass" class="sidebar-link">modelClass()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#skipundefined" class="sidebar-link">skipUndefined()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#transacting" class="sidebar-link">transacting()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#clone" class="sidebar-link">clone()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#execute" class="sidebar-link">execute()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#then" class="sidebar-link">then()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#catch" class="sidebar-link">catch()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#bind" class="sidebar-link">bind()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#resultsize" class="sidebar-link">resultSize()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#page" class="sidebar-link">page()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#range" class="sidebar-link">range()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#first" class="sidebar-link">first()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#throwifnotfound" class="sidebar-link">throwIfNotFound()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#timeout" class="sidebar-link">timeout()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#connection" class="sidebar-link">connection()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#modify" class="sidebar-link">modify()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/query-builder/other-methods.html#modifiers" class="sidebar-link">modifiers()</a></li></ul></li><li><a href="/objection.js/api/query-builder/static-methods.html" class="sidebar-link">Static Methods</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="other-methods"><a href="#other-methods" class="header-anchor">#</a> Other Methods</h1> <h2 id="debug"><a href="#debug" class="header-anchor">#</a> debug()</h2> <p>Chaining this method to any query will print all the executed SQL to console.</p> <p>See <a href="https://knexjs.org/guide/query-builder.html#debug" target="_blank" rel="noopener noreferrer">knex documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h5 id="return-value"><a href="#return-value" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h2 id="toknexquery"><a href="#toknexquery" class="header-anchor">#</a> toKnexQuery()</h2> <div class="language-js extra-class"><pre class="language-js"><code>knexQueryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">toKnexQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Compiles the query into a knex query and returns the knex query builder instance.</p> <p>Some objection queries, like when <code>withGraphFetched</code> is used, actually execute multiple queries. In these cases, the query builer of the first query is returned</p> <p>In some rare cases the knex query cannot be built synchronously. In these cases you will get a clear error message. These cases can be handled by calling the optional <a href="/objection.js/api/objection/#initialize">initialize</a> method once before the failing <code>toKnexQuery</code> method is called.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> initialize <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'objection'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">[</span>Person<span class="token punctuation">,</span> Pet<span class="token punctuation">,</span> Movie<span class="token punctuation">,</span> SomeOtherModelClass<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="for"><a href="#for" class="header-anchor">#</a> for()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span>relationOwner<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This method can only be used in conjunction with the static <a href="/objection.js/api/model/static-methods.html#static-relatedquery">relatedQuery</a> method. See the <a href="/objection.js/api/model/static-methods.html#static-relatedquery">relatedQuery</a> documentation on how to use it.</p> <p>This method takes one argument (the owner(s) of the relation) and it can have any of the following types:</p> <ul><li>A single identifier (can be composite)</li> <li>An array of identifiers (can be composite)</li> <li>A <a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></li> <li>A model instance.</li> <li>An array of model instances.</li></ul> <h2 id="context"><a href="#context" class="header-anchor">#</a> context()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>queryContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Sets/gets the query context.</p> <p>Some query builder methods create more than one query. The query context is an object that is shared with all queries started by a query builder.</p> <p>The context is also passed to <a href="/objection.js/api/model/instance-methods.html#beforeinsert">$beforeInsert</a>, <a href="/objection.js/api/model/instance-methods.html#afterinsert">$afterInsert</a>, <a href="/objection.js/api/model/instance-methods.html#beforeupdate">$beforeUpdate</a>, <a href="/objection.js/api/model/instance-methods.html#afterupdate">$afterUpdate</a>, <a href="/objection.js/api/model/instance-methods.html#beforedelete">$beforeDelete</a>, <a href="/objection.js/api/model/instance-methods.html#afterdelete">$afterDelete</a> and <a href="/objection.js/api/model/instance-methods.html#afterfind">$afterFind</a> calls that the query creates.</p> <p>In addition to properties added using this method the query context object always has a <code>transaction</code> property that holds the active transaction. If there is no active transaction the <code>transaction</code> property contains the normal knex instance. In both cases the value can be passed anywhere where a transaction object can be passed so you never need to check for the existence of the <code>transaction</code> property.</p> <p>This method merges the given object with the current context. You can use <code>clearContext</code> to clear the context if needed.</p> <p>See the methods <a href="/objection.js/api/query-builder/other-methods.html#runbefore">runBefore</a>, <a href="/objection.js/api/query-builder/other-methods.html#onbuild">onBuild</a> and <a href="/objection.js/api/query-builder/other-methods.html#runafter">runAfter</a>
for more information about the hooks.</p> <h5 id="arguments"><a href="#arguments" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>queryContext</td> <td>Object</td> <td>The query context object</td></tr></tbody></table> <h5 id="return-value-2"><a href="#return-value-2" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h5> <p>You can set the context like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">something</span><span class="token operator">:</span> <span class="token string">'hello'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>and access the context like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> context <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can set any data to the context object. You can also register QueryBuilder lifecycle methods for <em>all</em> queries that share the context:</p> <div class="language-js extra-class"><pre class="language-js"><code>Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">runBefore</span><span class="token punctuation">(</span><span class="token parameter">result<span class="token punctuation">,</span> builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">runAfter</span><span class="token punctuation">(</span><span class="token parameter">result<span class="token punctuation">,</span> builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onBuild</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>For example the <code>withGraphFetched</code> method causes multiple queries to be executed from a single query builder. If you wanted to make all of them use the same schema you could write this:</p> <div class="language-js extra-class"><pre class="language-js"><code>Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withGraphFetched</span><span class="token punctuation">(</span><span class="token string">'[movies, children.movies]'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">onBuild</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      builder<span class="token punctuation">.</span><span class="token function">withSchema</span><span class="token punctuation">(</span><span class="token string">'someSchema'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="clearcontext"><a href="#clearcontext" class="header-anchor">#</a> clearContext()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">clearContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Replaces the current context with an empty object.</p> <h5 id="return-value-3"><a href="#return-value-3" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h2 id="tablenamefor"><a href="#tablenamefor" class="header-anchor">#</a> tableNameFor()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> tableName <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">tableNameFor</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns the table name for a given model class in the query. Usually the table name can be fetched through <code>Model.tableName</code> but if the source table has been changed for example using the <a href="/objection.js/api/query-builder/find-methods.html#table">QueryBuilder#table</a> method <code>tableNameFor</code> will return the correct value.</p> <h5 id="arguments-2"><a href="#arguments-2" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>modelClass</td> <td>function</td> <td>A model class.</td></tr></tbody></table> <h5 id="return-value-4"><a href="#return-value-4" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>string</td> <td>The source table (or view) name for <code>modelClass</code>.</td></tr></tbody></table> <h2 id="tablereffor"><a href="#tablereffor" class="header-anchor">#</a> tableRefFor()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> tableRef <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">tableRefFor</span><span class="token punctuation">(</span>modelClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns the name that should be used to refer to the <code>modelClass</code>'s table in the query.
Usually a table can be referred to using its name, but <code>tableRefFor</code> can return a different
value for example in case an alias has been given.</p> <h5 id="arguments-3"><a href="#arguments-3" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>modelClass</td> <td>function</td> <td>A model class.</td></tr></tbody></table> <h5 id="return-value-5"><a href="#return-value-5" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>string</td> <td>The name that should be used to refer to a table in the query.</td></tr></tbody></table> <h2 id="reject"><a href="#reject" class="header-anchor">#</a> reject()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Skips the database query and &quot;fakes&quot; an error result.</p> <h5 id="arguments-4"><a href="#arguments-4" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>reason</td> <td></td> <td>The rejection reason</td></tr></tbody></table> <h5 id="return-value-6"><a href="#return-value-6" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h2 id="resolve"><a href="#resolve" class="header-anchor">#</a> resolve()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Skips the database query and &quot;fakes&quot; a result.</p> <h5 id="arguments-5"><a href="#arguments-5" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>value</td> <td></td> <td>The resolve value</td></tr></tbody></table> <h5 id="return-value-7"><a href="#return-value-7" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h2 id="isexecutable"><a href="#isexecutable" class="header-anchor">#</a> isExecutable()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> isExecutable <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">isExecutable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns false if this query will never be executed.</p> <p>This may be true in multiple cases:</p> <ol><li>The query is explicitly resolved or rejected using the <a href="/objection.js/api/query-builder/other-methods.html#resolve">resolve</a> or <a href="/objection.js/api/query-builder/other-methods.html#reject">reject</a> methods.</li> <li>The query starts a different query when it is executed.</li></ol> <h5 id="return-value-8"><a href="#return-value-8" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>false if the query will never be executed.</td></tr></tbody></table> <h2 id="isfind"><a href="#isfind" class="header-anchor">#</a> isFind()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> isFind <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">isFind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true if the query is read-only.</p> <h5 id="return-value-9"><a href="#return-value-9" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if the query is read-only.</td></tr></tbody></table> <h2 id="isinsert"><a href="#isinsert" class="header-anchor">#</a> isInsert()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> isInsert <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">isInsert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true if the query performs an insert operation.</p> <h5 id="return-value-10"><a href="#return-value-10" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if the query performs an insert operation.</td></tr></tbody></table> <h2 id="isupdate"><a href="#isupdate" class="header-anchor">#</a> isUpdate()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> isUpdate <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">isUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true if the query performs an update or patch operation.</p> <h5 id="return-value-11"><a href="#return-value-11" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if the query performs an update or patch operation.</td></tr></tbody></table> <h2 id="isdelete"><a href="#isdelete" class="header-anchor">#</a> isDelete()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> isDelete <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">isDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true if the query performs a delete operation.</p> <h5 id="return-value-12"><a href="#return-value-12" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if the query performs a delete operation.</td></tr></tbody></table> <h2 id="isrelate"><a href="#isrelate" class="header-anchor">#</a> isRelate()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> isRelate <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">isRelate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true if the query performs a relate operation.</p> <h5 id="return-value-13"><a href="#return-value-13" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if the query performs a relate operation.</td></tr></tbody></table> <h2 id="isunrelate"><a href="#isunrelate" class="header-anchor">#</a> isUnrelate()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> isUnrelate <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">isUnrelate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true if the query performs an unrelate operation.</p> <h5 id="return-value-14"><a href="#return-value-14" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if the query performs an unrelate operation.</td></tr></tbody></table> <h2 id="isinternal"><a href="#isinternal" class="header-anchor">#</a> isInternal()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> isInternal <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">isInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true for internal &quot;helper&quot; queries that are not directly
part of the operation being executed. For example the <code>select</code> queries
performed by <code>upsertGraph</code> to get the current state of the graph are
internal queries.</p> <h5 id="return-value-15"><a href="#return-value-15" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if the query performs an internal helper operation.</td></tr></tbody></table> <h2 id="haswheres"><a href="#haswheres" class="header-anchor">#</a> hasWheres()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> hasWheres <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">hasWheres</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true if the query contains where statements.</p> <h5 id="return-value-16"><a href="#return-value-16" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if the query contains where statements.</td></tr></tbody></table> <h2 id="hasselects"><a href="#hasselects" class="header-anchor">#</a> hasSelects()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> hasSelects <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">hasSelects</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true if the query contains any specific select staments, such as:
<code>'select'</code>, <code>'columns'</code>, <code>'column'</code>, <code>'distinct'</code>, <code>'count'</code>, <code>'countDistinct'</code>, <code>'min'</code>, <code>'max'</code>, <code>'sum'</code>, <code>'sumDistinct'</code>, <code>'avg'</code>, <code>'avgDistinct'</code></p> <h5 id="return-value-17"><a href="#return-value-17" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if the query contains any specific select staments.</td></tr></tbody></table> <h2 id="haswithgraph"><a href="#haswithgraph" class="header-anchor">#</a> hasWithGraph()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> hasWithGraph <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">hasWithGraph</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true if <code>withGraphFetched</code> or <code>withGraphJoined</code> has been called for the query.</p> <h5 id="return-value-18"><a href="#return-value-18" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if <code>withGraphFetched</code> or <code>withGraphJoined</code> has been called for the query.</td></tr></tbody></table> <h2 id="has"><a href="#has" class="header-anchor">#</a> has()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> has <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
  Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">'range'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns true if the query defines an operation that matches the given selector.</p> <h5 id="arguments-6"><a href="#arguments-6" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>selector</td> <td>string¬†|¬†RegExp</td> <td>A name or regular expression to match all defined operations against.</td></tr></tbody></table> <h5 id="return-value-19"><a href="#return-value-19" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>boolean</td> <td>true if the query defines an operation that matches the given selector.</td></tr></tbody></table> <h2 id="clear"><a href="#clear" class="header-anchor">#</a> clear()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Removes all operations in the query that match the given selector.</p> <h5 id="arguments-7"><a href="#arguments-7" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>selector</td> <td>string¬†|¬†regexp</td> <td>A name or regular expression to match all operations that are to be removed against.</td></tr></tbody></table> <h5 id="return-value-20"><a href="#return-value-20" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-2"><a href="#examples-2" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
  Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token string">'orderBy'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">'orderBy'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="runbefore"><a href="#runbefore" class="header-anchor">#</a> runBefore()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">runBefore</span><span class="token punctuation">(</span>runBefore<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Registers a function to be called before just the database query when the builder is executed. Multiple functions can be chained like <code>then</code> methods of a promise.</p> <h5 id="arguments-8"><a href="#arguments-8" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>runBefore</td> <td>function(result,¬†<a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a>)</td> <td>The function to be executed. This function can be async. Note that it needs to return the result used for further processing in the chain of calls.</td></tr></tbody></table> <h5 id="return-value-21"><a href="#return-value-21" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-3"><a href="#examples-3" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> query <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

query
  <span class="token punctuation">.</span><span class="token function">runBefore</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello 1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello 2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">runBefore</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello 3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> query<span class="token punctuation">;</span>
<span class="token comment">// --&gt; hello 1</span>
<span class="token comment">// --&gt; hello 2</span>
<span class="token comment">// --&gt; hello 3</span>
</code></pre></div><h2 id="onbuild"><a href="#onbuild" class="header-anchor">#</a> onBuild()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">onBuild</span><span class="token punctuation">(</span>onBuild<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Functions registered with this method are called each time the query is built into an SQL string. This method is ran after <a href="/objection.js/api/query-builder/other-methods.html#runbefore">runBefore</a> methods but before <a href="/objection.js/api/query-builder/other-methods.html#runafter">runAfter</a> methods.</p> <p>If you need to modify the SQL query at query build time, this is the place to do it. You shouldn't modify the query in any of the <code>run</code> methods.</p> <p>Unlike the <code>run</code> methods (<code>runAfter</code>, <code>runBefore</code> etc.) these must be synchronous. Also you should not register any <code>run</code> methods from these. You should <em>only</em> call the query building methods of the builder provided as a parameter.</p> <h5 id="arguments-9"><a href="#arguments-9" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>onBuild</td> <td>function(<a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a>)</td> <td>The <strong>synchronous</strong> function to be executed.</td></tr></tbody></table> <h5 id="return-value-22"><a href="#return-value-22" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="eamples"><a href="#eamples" class="header-anchor">#</a> Eamples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> query <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

query
  <span class="token punctuation">.</span><span class="token function">onBuild</span><span class="token punctuation">(</span><span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">onBuild</span><span class="token punctuation">(</span><span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">orWhere</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="onbuildknex"><a href="#onbuildknex" class="header-anchor">#</a> onBuildKnex()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">onBuildKnex</span><span class="token punctuation">(</span>onBuildKnex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Functions registered with this method are called each time the query is built into an SQL string. This method is ran after <a href="/objection.js/api/query-builder/other-methods.html#onbuild">onBuild</a> methods but before <a href="/objection.js/api/query-builder/other-methods.html#runafter">runAfter</a> methods.</p> <p>If you need to modify the SQL query at query build time, this is the place to do it in addition to <code>onBuild</code>. The only difference between <code>onBuildKnex</code> and <code>onBuild</code> is that in <code>onBuild</code> you can modify the objection's query builder. In <code>onBuildKnex</code> the objection builder has been compiled into a knex query builder and any modifications to the objection builder will be ignored.</p> <p>Unlike the <code>run</code> methods (<code>runAfter</code>, <code>runBefore</code> etc.) these must be synchronous. Also you should not register any <code>run</code> methods from these. You should <em>only</em> call the query building methods of the <strong>knexBuilder</strong> provided as a parameter.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>You should never call any query building (or any other mutating) method on the <code>objectionBuilder</code> in this function. If you do, those calls will get ignored. At this point the query builder has been compiled into a knex query builder and you should only modify that. You can call non mutating methods like <code>hasSelects</code>, <code>hasWheres</code> etc. on the objection builder.</p></div> <h5 id="arguments-10"><a href="#arguments-10" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>onBuildKnex</td> <td>function(<code>KnexQueryBuilder</code>,¬†<a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a>)</td> <td>The function to be executed.</td></tr></tbody></table> <h5 id="return-value-23"><a href="#return-value-23" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-4"><a href="#examples-4" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> query <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

query<span class="token punctuation">.</span><span class="token function">onBuildKnex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">knexBuilder<span class="token punctuation">,</span> objectionBuilder</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  knexBuilder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="runafter"><a href="#runafter" class="header-anchor">#</a> runAfter()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">runAfter</span><span class="token punctuation">(</span>runAfter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Registers a function to be called when the builder is executed.</p> <p>These functions are executed as the last thing before any promise handlers registered using the <a href="/objection.js/api/query-builder/other-methods.html#then">then</a> method. Multiple functions can be chained like <a href="/objection.js/api/query-builder/other-methods.html#then">then</a> methods of a promise.</p> <h5 id="arguments-11"><a href="#arguments-11" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>runAfter</td> <td>function(result,¬†<a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a>)</td> <td>The function to be executed. This function can be async. Note that it needs to return the result used for further processing in the chain of calls.</td></tr></tbody></table> <h5 id="return-value-24"><a href="#return-value-24" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-5"><a href="#examples-5" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> query <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

query
  <span class="token punctuation">.</span><span class="token function">runAfter</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">models<span class="token punctuation">,</span> queryBuilder</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> models<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">runAfter</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">models<span class="token punctuation">,</span> queryBuilder</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    models<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">'Jennifer'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> models<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> models <span class="token operator">=</span> <span class="token keyword">await</span> query<span class="token punctuation">;</span>
</code></pre></div><h2 id="onerror"><a href="#onerror" class="header-anchor">#</a> onError()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span>onError<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Registers an error handler. Just like <code>catch</code> but doesn't execute the query.</p> <h5 id="arguments-12"><a href="#arguments-12" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>onError</td> <td>function(Error,¬†<a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a>)</td> <td>The function to be executed on error.</td></tr></tbody></table> <h5 id="return-value-25"><a href="#return-value-25" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-6"><a href="#examples-6" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> query <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

query
  <span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> queryBuilder</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// Handle `SomeError` but let other errors go through.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name">SomeError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// This will cause the query to be resolved with an object</span>
      <span class="token comment">// instead of throwing an error.</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'some error occurred'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="castto"><a href="#castto" class="header-anchor">#</a> castTo()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">castTo</span><span class="token punctuation">(</span>ModelClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">castTo</span><span class="token generic class-name"><span class="token operator">&lt;</span>SomeType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Sets the model class of the result rows or if no arguments are provided, simply casts the
result type to the provided type.</p> <h5 id="return-value-26"><a href="#return-value-26" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/model/">ModelClass</a></td> <td>The model class of the result rows.</td></tr></tbody></table> <h5 id="return-value-27"><a href="#return-value-27" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-7"><a href="#examples-7" class="header-anchor">#</a> Examples</h5> <p>The following example creates a query through <code>Person</code>, joins a bunch of relations, selects
only the related <code>Animal</code>'s columns and returns the results as <code>Animal</code> instances instead
of <code>Person</code> instances.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> animals <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">joinRelated</span><span class="token punctuation">(</span><span class="token string">'children.children.pets'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'children:children:pets.*'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">castTo</span><span class="token punctuation">(</span>Animal<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If you don't provide any arguments for the method, but provide a generic type argument, the
result is not changed but its typescript type is cast to the given generic type.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Named</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'firstName as name'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token generic-function"><span class="token function">castTo</span><span class="token generic class-name"><span class="token operator">&lt;</span>Named<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="modelclass"><a href="#modelclass" class="header-anchor">#</a> modelClass()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> modelClass <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">modelClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Gets the Model subclass this builder is bound to.</p> <h5 id="return-value-28"><a href="#return-value-28" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/model/">Model</a></td> <td>The Model subclass this builder is bound to</td></tr></tbody></table> <h2 id="skipundefined"><a href="#skipundefined" class="header-anchor">#</a> skipUndefined()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">skipUndefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If this method is called for a builder then undefined values passed to the query builder methods don't cause an exception but are ignored instead.</p> <p>For example the following query will return all <code>Person</code> rows if <code>req.query.firstName</code> is <code>undefined</code>.</p> <h5 id="return-value-29"><a href="#return-value-29" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining</td></tr></tbody></table> <h5 id="examples-8"><a href="#examples-8" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code>Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">skipUndefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>firstName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="transacting"><a href="#transacting" class="header-anchor">#</a> transacting()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">transacting</span><span class="token punctuation">(</span>transaction<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Sets the transaction for a query.</p> <h5 id="arguments-13"><a href="#arguments-13" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>transaction</td> <td>object</td> <td>A transaction object</td></tr></tbody></table> <h5 id="return-value-30"><a href="#return-value-30" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining</td></tr></tbody></table> <h2 id="clone"><a href="#clone" class="header-anchor">#</a> clone()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> clone <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Create a clone of this builder.</p> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td>Clone of the query builder</td></tr></tbody></table> <h2 id="execute"><a href="#execute" class="header-anchor">#</a> execute()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> promise <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Executes the query and returns a Promise.</p> <h5 id="return-value-31"><a href="#return-value-31" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Promise</code></td> <td>Promise the will be resolved with the result of the query.</td></tr></tbody></table> <h2 id="then"><a href="#then" class="header-anchor">#</a> then()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> promise <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>successHandler<span class="token punctuation">,</span> errorHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Executes the query and returns a Promise.</p> <h5 id="arguments-14"><a href="#arguments-14" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Default</th> <th>Description</th></tr></thead> <tbody><tr><td>successHandler</td> <td>function</td> <td>identity</td> <td>Promise success handler</td></tr> <tr><td>errorHandler</td> <td>function</td> <td>identity</td> <td>Promise error handler</td></tr></tbody></table> <h5 id="return-value-32"><a href="#return-value-32" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Promise</code></td> <td>Promise the will be resolved with the result of the query.</td></tr></tbody></table> <h2 id="catch"><a href="#catch" class="header-anchor">#</a> catch()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> promise <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>errorHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Executes the query and calls <code>catch(errorHandler)</code> for the returned promise.</p> <h5 id="arguments-15"><a href="#arguments-15" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Default</th> <th>Description</th></tr></thead> <tbody><tr><td>errorHandler</td> <td>function</td> <td>identity</td> <td>Error handler</td></tr></tbody></table> <h5 id="return-value-33"><a href="#return-value-33" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Promise</code></td> <td>Promise the will be resolved with the result of the query.</td></tr></tbody></table> <h2 id="bind"><a href="#bind" class="header-anchor">#</a> bind()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> promise <span class="token operator">=</span> <span class="token function">queryBuilder</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>returnValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Executes the query and calls <code>bind(context)</code> for the returned promise.</p> <h5 id="arguments-16"><a href="#arguments-16" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Default</th> <th>Description</th></tr></thead> <tbody><tr><td>context</td> <td></td> <td>undefined</td> <td>Bind context</td></tr></tbody></table> <h5 id="return-value-34"><a href="#return-value-34" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Promise</code></td> <td>Promise the will be resolved with the result of the query.</td></tr></tbody></table> <h2 id="resultsize"><a href="#resultsize" class="header-anchor">#</a> resultSize()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> promise <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">resultSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns the amount of rows the current query would produce without <a href="/objection.js/api/query-builder/find-methods.html#limit">limit</a> and <a href="/objection.js/api/query-builder/find-methods.html#offset">offset</a> applied. Note that this executes a copy of the query and returns a Promise.</p> <p>This method is often more convenient than <code>count</code> which returns an array of objects instead a single number.</p> <h5 id="return-value-35"><a href="#return-value-35" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Promise&lt;number&gt;</code></td> <td>Promise the will be resolved with the result size.</td></tr></tbody></table> <h5 id="examples-9"><a href="#examples-9" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> query <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>total<span class="token punctuation">,</span> models<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  query<span class="token punctuation">.</span><span class="token function">resultSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  query<span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="page"><a href="#page" class="header-anchor">#</a> page()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>results<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 100</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 3341</span>
</code></pre></div><p>Two queries are performed by this method: the actual query and a query to get the <code>total</code> count.</p> <p>Mysql has the <code>SQL_CALC_FOUND_ROWS</code> option and <code>FOUND_ROWS()</code> function that can be used to calculate the result size, but according to my tests and <a href="http://www.google.com/search?q=SQL_CALC_FOUND_ROWS+performance" target="_blank" rel="noopener noreferrer">the interwebs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> the performance is significantly worse than just executing a separate count query.</p> <p>Postgresql has window functions that can be used to get the total count like this <code>select count(*) over () as total</code>. The problem with this is that if the result set is empty, we don't get the total count either. (If someone can figure out a way around this, a PR is very welcome).</p> <h5 id="arguments-17"><a href="#arguments-17" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>page</td> <td>number</td> <td>The index of the page to return. The index of the first page is 0.</td></tr> <tr><td>pageSize</td> <td>number</td> <td>The page size</td></tr></tbody></table> <h5 id="return-value-36"><a href="#return-value-36" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining</td></tr></tbody></table> <h2 id="range"><a href="#range" class="header-anchor">#</a> range()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Only returns the given range of results.</p> <p>Two queries are performed by this method: the actual query and a query to get the <code>total</code> count.</p> <p>Mysql has the <code>SQL_CALC_FOUND_ROWS</code> option and <code>FOUND_ROWS()</code> function that can be used to calculate the result size, but according to my tests and <a href="http://www.google.com/search?q=SQL_CALC_FOUND_ROWS+performance" target="_blank" rel="noopener noreferrer">the interwebs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> the performance is significantly worse than just executing a separate count query.</p> <p>Postgresql has window functions that can be used to get the total count like this <code>select count(*) over () as total</code>. The problem with this is that if the result set is empty, we don't get the total count either. (If someone can figure out a way around this, a PR is very welcome).</p> <h5 id="arguments-18"><a href="#arguments-18" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>start</td> <td>number</td> <td>The index of the first result (inclusive)</td></tr> <tr><td>end</td> <td>number</td> <td>The index of the last result (inclusive)</td></tr></tbody></table> <h5 id="return-value-37"><a href="#return-value-37" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining</td></tr></tbody></table> <h5 id="examples-10"><a href="#examples-10" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>results<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 101</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 3341</span>
</code></pre></div><p><code>range</code> can be called without arguments if you want to specify the limit and offset explicitly:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>results<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 101</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 3341</span>
</code></pre></div><h2 id="first"><a href="#first" class="header-anchor">#</a> first()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If the result is an array, selects the first item.</p> <p>NOTE: This doesn't add <code>limit 1</code> to the query by default. You can override the <a href="/objection.js/api/model/static-properties.html#static-uselimitinfirst">Model.useLimitInFirst</a> property to change this behaviour.</p> <p>Also see <a href="/objection.js/api/query-builder/find-methods.html#findbyid">findById</a> and <a href="/objection.js/api/query-builder/find-methods.html#findone">findOne</a> shorthand methods.</p> <h5 id="return-value-38"><a href="#return-value-38" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining</td></tr></tbody></table> <h5 id="examples-11"><a href="#examples-11" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> firstPerson <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>firstPerson<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="throwifnotfound"><a href="#throwifnotfound" class="header-anchor">#</a> throwIfNotFound()</h2> <div class="language-js extra-class"><pre class="language-js"><code>queryBuilder <span class="token operator">=</span> queryBuilder<span class="token punctuation">.</span><span class="token function">throwIfNotFound</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Causes a <a href="/objection.js/api/types/#class-notfounderror">Model.NotFoundError</a> to be thrown if the query result is empty.</p> <p>You can replace <code>Model.NotFoundError</code> with your own error by implementing the static <a href="/objection.js/api/model/static-methods.html#static-createnotfounderror">Model.createNotFoundError(ctx)</a> method.</p> <h5 id="arguments-19"><a href="#arguments-19" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>data</td> <td>object</td> <td>optional object with custom data may contain any property such as message, type. The object is returned in the error thrown under the <code>data</code> property. A special case is for the optional message property. This is used to set the title of the error. These extra properties can be leveraged in the error handling middleware</td></tr></tbody></table> <h5 id="return-value-39"><a href="#return-value-39" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining</td></tr></tbody></table> <h5 id="examples-12"><a href="#examples-12" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> Language<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'Java'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">andWhere</span><span class="token punctuation">(</span><span class="token string">'isModern'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">throwIfNotFound</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Custom message returned</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Custom type</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// No results found.</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err <span class="token keyword">instanceof</span> <span class="token class-name">Language<span class="token punctuation">.</span>NotFoundError</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; true</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="timeout"><a href="#timeout" class="header-anchor">#</a> timeout()</h2> <p>See <a href="https://knexjs.org/guide/query-builder.html#debug" target="_blank" rel="noopener noreferrer">knex documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h5 id="return-value-40"><a href="#return-value-40" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h2 id="connection"><a href="#connection" class="header-anchor">#</a> connection()</h2> <p>See <a href="https://knexjs.org/guide/query-builder.html#connection" target="_blank" rel="noopener noreferrer">knex documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h5 id="return-value-41"><a href="#return-value-41" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h2 id="modify"><a href="#modify" class="header-anchor">#</a> modify()</h2> <p>Works like <code>knex</code>'s <a href="https://knexjs.org/guide/query-builder.html#modify" target="_blank" rel="noopener noreferrer">modify<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> function but in addition you can specify a <a href="/objection.js/api/model/static-properties.html#static-modifiers">modifier</a> by providing modifier names.</p> <p>See the <a href="/objection.js/recipes/modifiers.html">modifier</a> recipe for examples of the things you can do with modifiers.</p> <h5 id="arguments-20"><a href="#arguments-20" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>modifier</td> <td>function(<a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a>)¬†|¬†string¬†|¬†string[]</td> <td>The modify callback function, receiving the builder as its first argument, followed by the optional arguments. If a string or an array of strings is provided, the corresponding <a href="/objection.js/api/model/static-properties.html#static-modifiers">modifier</a> is executed instead.</td></tr> <tr><td>*arguments</td> <td>...any</td> <td>The optional arguments passed to the modify function</td></tr></tbody></table> <h5 id="examples-13"><a href="#examples-13" class="header-anchor">#</a> Examples</h5> <p>The first argument can be a name of a <a href="/objection.js/api/model/static-properties.html#static-modifiers">model modifier</a>. The rest of the arguments are passed as arguments for the modifier.</p> <div class="language-js extra-class"><pre class="language-js"><code>Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modify</span><span class="token punctuation">(</span><span class="token string">'someModifier'</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can also pass an array of modifier names:</p> <div class="language-js extra-class"><pre class="language-js"><code>Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modify</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'someModifier'</span><span class="token punctuation">,</span> <span class="token string">'someOtherModifier'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The first argument can be a function:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">modifierFunc</span><span class="token punctuation">(</span><span class="token parameter">query<span class="token punctuation">,</span> arg1<span class="token punctuation">,</span> arg2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  query<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modify</span><span class="token punctuation">(</span>modifierFunc<span class="token punctuation">,</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="return-value-42"><a href="#return-value-42" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h2 id="modifiers"><a href="#modifiers" class="header-anchor">#</a> modifiers()</h2> <p>Registers modifiers for the query.</p> <p>You can call this method without arguments to get the currently registered modifiers.</p> <p>See the <a href="/objection.js/recipes/modifiers.html">modifier recipe</a> for more info and examples.</p> <h5 id="return-value-43"><a href="#return-value-43" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/" class="router-link-active">QueryBuilder</a></td> <td><code>this</code> query builder for chaining.</td></tr></tbody></table> <h5 id="examples-14"><a href="#examples-14" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modifiers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">selectFields</span><span class="token operator">:</span> <span class="token parameter">query</span> <span class="token operator">=&gt;</span> query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// In the following modifier, `filterGender` is a modifier</span>
    <span class="token comment">// registered in Person.modifiers object. Query modifiers</span>
    <span class="token comment">// can be used to bind arguments to model modifiers like this.</span>
    <span class="token function-variable function">filterWomen</span><span class="token operator">:</span> <span class="token parameter">query</span> <span class="token operator">=&gt;</span> query<span class="token punctuation">.</span><span class="token function">modify</span><span class="token punctuation">(</span><span class="token string">'filterGender'</span><span class="token punctuation">,</span> <span class="token string">'female'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modify</span><span class="token punctuation">(</span><span class="token string">'selectFields'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withGraphFetched</span><span class="token punctuation">(</span><span class="token string">'children(selectFields, filterWomen)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can get the currently registered modifiers by calling the method without arguments.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> modifiers <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">modifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/objection.js/api/query-builder/join-methods.html" class="prev">
        Join Methods
      </a></span> <span class="next"><a href="/objection.js/api/query-builder/static-methods.html">
        Static Methods
      </a>
      ‚Üí
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/objection.js/assets/js/app.aac9f1d1.js" defer></script><script src="/objection.js/assets/js/2.95f20b73.js" defer></script><script src="/objection.js/assets/js/1.317fd1a4.js" defer></script><script src="/objection.js/assets/js/40.1106236d.js" defer></script>
  </body>
</html>
