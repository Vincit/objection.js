<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Static Methods | Objection.js</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="An SQL friendly ORM for node.js">
    
    <link rel="preload" href="/objection.js/assets/css/0.styles.c1c067d3.css" as="style"><link rel="preload" href="/objection.js/assets/js/app.398a341a.js" as="script"><link rel="preload" href="/objection.js/assets/js/6.57603b17.js" as="script"><link rel="preload" href="/objection.js/assets/js/7.76e572ea.js" as="script"><link rel="preload" href="/objection.js/assets/js/17.dbe720da.js" as="script"><link rel="prefetch" href="/objection.js/assets/js/1.f8c22fbb.js"><link rel="prefetch" href="/objection.js/assets/js/10.9c896f6d.js"><link rel="prefetch" href="/objection.js/assets/js/11.ace53e4c.js"><link rel="prefetch" href="/objection.js/assets/js/12.33adf40a.js"><link rel="prefetch" href="/objection.js/assets/js/13.f07dba75.js"><link rel="prefetch" href="/objection.js/assets/js/14.e7c6a543.js"><link rel="prefetch" href="/objection.js/assets/js/15.164de766.js"><link rel="prefetch" href="/objection.js/assets/js/16.666588c8.js"><link rel="prefetch" href="/objection.js/assets/js/18.2f1bedc3.js"><link rel="prefetch" href="/objection.js/assets/js/19.b3d5dd41.js"><link rel="prefetch" href="/objection.js/assets/js/2.73dd4665.js"><link rel="prefetch" href="/objection.js/assets/js/20.b93536f4.js"><link rel="prefetch" href="/objection.js/assets/js/21.666eb05e.js"><link rel="prefetch" href="/objection.js/assets/js/22.a738e979.js"><link rel="prefetch" href="/objection.js/assets/js/23.c54fc237.js"><link rel="prefetch" href="/objection.js/assets/js/24.cecb5fe0.js"><link rel="prefetch" href="/objection.js/assets/js/25.d40f12b9.js"><link rel="prefetch" href="/objection.js/assets/js/26.8048250b.js"><link rel="prefetch" href="/objection.js/assets/js/27.73e35c56.js"><link rel="prefetch" href="/objection.js/assets/js/28.3ba6ef4e.js"><link rel="prefetch" href="/objection.js/assets/js/29.048e2132.js"><link rel="prefetch" href="/objection.js/assets/js/3.bd676c39.js"><link rel="prefetch" href="/objection.js/assets/js/30.36b7a378.js"><link rel="prefetch" href="/objection.js/assets/js/31.2ce74590.js"><link rel="prefetch" href="/objection.js/assets/js/32.b6c7d5c4.js"><link rel="prefetch" href="/objection.js/assets/js/33.9f6746d7.js"><link rel="prefetch" href="/objection.js/assets/js/34.e93f1327.js"><link rel="prefetch" href="/objection.js/assets/js/35.a62898e1.js"><link rel="prefetch" href="/objection.js/assets/js/36.b12179c8.js"><link rel="prefetch" href="/objection.js/assets/js/37.92069324.js"><link rel="prefetch" href="/objection.js/assets/js/38.1243c98d.js"><link rel="prefetch" href="/objection.js/assets/js/39.c69323bf.js"><link rel="prefetch" href="/objection.js/assets/js/40.982eb97c.js"><link rel="prefetch" href="/objection.js/assets/js/41.3b55bfc1.js"><link rel="prefetch" href="/objection.js/assets/js/42.2f15bc8b.js"><link rel="prefetch" href="/objection.js/assets/js/43.f56a2439.js"><link rel="prefetch" href="/objection.js/assets/js/44.6ad5d6c3.js"><link rel="prefetch" href="/objection.js/assets/js/45.f95647c8.js"><link rel="prefetch" href="/objection.js/assets/js/46.1a6c8b55.js"><link rel="prefetch" href="/objection.js/assets/js/47.41901d64.js"><link rel="prefetch" href="/objection.js/assets/js/48.b310215b.js"><link rel="prefetch" href="/objection.js/assets/js/49.e8d40bd5.js"><link rel="prefetch" href="/objection.js/assets/js/50.5ab8b328.js"><link rel="prefetch" href="/objection.js/assets/js/51.50fd2647.js"><link rel="prefetch" href="/objection.js/assets/js/52.1e2c2d01.js"><link rel="prefetch" href="/objection.js/assets/js/53.054aec65.js"><link rel="prefetch" href="/objection.js/assets/js/54.29f2f3af.js"><link rel="prefetch" href="/objection.js/assets/js/55.ad38fb57.js"><link rel="prefetch" href="/objection.js/assets/js/56.59467b7b.js"><link rel="prefetch" href="/objection.js/assets/js/57.ac2d360c.js"><link rel="prefetch" href="/objection.js/assets/js/58.b26481e2.js"><link rel="prefetch" href="/objection.js/assets/js/59.3bf5a25f.js"><link rel="prefetch" href="/objection.js/assets/js/60.5045f31d.js"><link rel="prefetch" href="/objection.js/assets/js/8.658dbe25.js"><link rel="prefetch" href="/objection.js/assets/js/9.436283ab.js"><link rel="prefetch" href="/objection.js/assets/js/vendors~docsearch.e4094a40.js">
    <link rel="stylesheet" href="/objection.js/assets/css/0.styles.c1c067d3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/objection.js/" class="home-link router-link-active"><!----> <span class="site-name">Objection.js</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/objection.js/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API Reference" class="dropdown-title"><span class="title">API Reference</span> <span class="arrow down"></span></button> <button type="button" aria-label="API Reference" class="mobile-dropdown-title"><span class="title">API Reference</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/api/objection/" class="nav-link">
  Main Module
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/query-builder/" class="nav-link">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/model/" class="nav-link router-link-active">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/types/" class="nav-link">
  Types
</a></li></ul></div></div><div class="nav-item"><a href="/objection.js/recipes/" class="nav-link">
  Recipe Book
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Release Notes" class="dropdown-title"><span class="title">Release Notes</span> <span class="arrow down"></span></button> <button type="button" aria-label="Release Notes" class="mobile-dropdown-title"><span class="title">Release Notes</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/changelog.html" class="nav-link">
  Changelog
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/migration.html" class="nav-link">
  Migration to 3.0
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Vincit/objection.js/tree/v2/doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v2.x documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Vincit/objection.js/tree/v1/doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐ Star
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/objection.js/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API Reference" class="dropdown-title"><span class="title">API Reference</span> <span class="arrow down"></span></button> <button type="button" aria-label="API Reference" class="mobile-dropdown-title"><span class="title">API Reference</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/api/objection/" class="nav-link">
  Main Module
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/query-builder/" class="nav-link">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/model/" class="nav-link router-link-active">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/types/" class="nav-link">
  Types
</a></li></ul></div></div><div class="nav-item"><a href="/objection.js/recipes/" class="nav-link">
  Recipe Book
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Release Notes" class="dropdown-title"><span class="title">Release Notes</span> <span class="arrow down"></span></button> <button type="button" aria-label="Release Notes" class="mobile-dropdown-title"><span class="title">Release Notes</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/changelog.html" class="nav-link">
  Changelog
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/migration.html" class="nav-link">
  Migration to 3.0
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Vincit/objection.js/tree/v2/doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v2.x documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Vincit/objection.js/tree/v1/doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐ Star
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Model API Reference</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/objection.js/api/model/overview.html" class="sidebar-link">Overview</a></li><li><a href="/objection.js/api/model/static-properties.html" class="sidebar-link">Static Properties</a></li><li><a href="/objection.js/api/model/static-methods.html" aria-current="page" class="active sidebar-link">Static Methods</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-query" class="sidebar-link">static query()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-relatedquery" class="sidebar-link">static relatedQuery()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-knex" class="sidebar-link">static knex()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-transaction" class="sidebar-link">static transaction()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-starttransaction" class="sidebar-link">static startTransaction()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-beforefind" class="sidebar-link">static beforeFind()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-afterfind" class="sidebar-link">static afterFind()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-beforeupdate" class="sidebar-link">static beforeUpdate()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-afterupdate" class="sidebar-link">static afterUpdate()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-beforeinsert" class="sidebar-link">static beforeInsert()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-afterinsert" class="sidebar-link">static afterInsert()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-beforedelete" class="sidebar-link">static beforeDelete()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-afterdelete" class="sidebar-link">static afterDelete()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-bindknex" class="sidebar-link">static bindKnex()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-bindtransaction" class="sidebar-link">static bindTransaction()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-fromjson" class="sidebar-link">static fromJson()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-fromdatabasejson" class="sidebar-link">static fromDatabaseJson()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-modifiernotfound" class="sidebar-link">static modifierNotFound()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-createvalidator" class="sidebar-link">static createValidator()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-createnotfounderror" class="sidebar-link">static createNotFoundError()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-createvalidationerror" class="sidebar-link">static createValidationError()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-fetchgraph" class="sidebar-link">static fetchGraph()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-traverseasync" class="sidebar-link">static traverseAsync()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-getrelations" class="sidebar-link">static getRelations()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-columnnametopropertyname" class="sidebar-link">static columnNameToPropertyName()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-propertynametocolumnname" class="sidebar-link">static propertyNameToColumnName()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-fetchtablemetadata" class="sidebar-link">static fetchTableMetadata()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-tablemetadata" class="sidebar-link">static tableMetadata()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-raw" class="sidebar-link">static raw()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-ref" class="sidebar-link">static ref()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-fn" class="sidebar-link">static fn()</a></li><li class="sidebar-sub-header"><a href="/objection.js/api/model/static-methods.html#static-knexquery" class="sidebar-link">static knexQuery()</a></li></ul></li><li><a href="/objection.js/api/model/instance-methods.html" class="sidebar-link">Instance Methods</a></li><li><a href="/objection.js/api/model/instance-properties.html" class="sidebar-link">Instance Properties</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="static-methods"><a href="#static-methods" class="header-anchor">#</a> Static Methods</h1> <h2 id="static-query"><a href="#static-query" class="header-anchor">#</a> <code>static</code> query()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> queryBuilder <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>transactionOrKnex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates a query builder for the model's table.</p> <p>All query builders are created using this function, including <code>$query</code>, <code>relatedQuery</code> and <code>$relatedQuery</code>. That means you can modify each query by overriding this method for your model class.</p> <p>See the <a href="/objection.js/guide/query-examples.html">query examples</a> section for more examples.</p> <h4 id="arguments"><a href="#arguments" class="header-anchor">#</a> Arguments</h4> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>transactionOrKnex</td> <td>object</td> <td>Optional transaction or knex instance for the query. This can be used to specify a transaction or even a different database. for a query. Falsy values are ignored.</td></tr></tbody></table> <h4 id="return-value"><a href="#return-value" class="header-anchor">#</a> Return value</h4> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/">QueryBuilder</a></td> <td>The created query builder</td></tr></tbody></table> <h4 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h4> <p>Read models from the database:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Get all rows.</span>
<span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'there are'</span><span class="token punctuation">,</span> people<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token string">'people in the database'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Example of a more complex WHERE clause. This generates:</span>
<span class="token comment">// SELECT &quot;persons&quot;.*</span>
<span class="token comment">// FROM &quot;persons&quot;</span>
<span class="token comment">// WHERE (&quot;firstName&quot; = 'Jennifer' AND &quot;age&quot; &lt; 30)</span>
<span class="token comment">// OR (&quot;firstName&quot; = 'Mark' AND &quot;age&quot; &gt; 30)</span>
<span class="token keyword">const</span> marksAndJennifers <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">,</span> <span class="token string">'Jennifer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&lt;'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">orWhere</span><span class="token punctuation">(</span><span class="token parameter">builder</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">,</span> <span class="token string">'Mark'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>marksAndJennifers<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get a subset of rows and fetch related models</span>
<span class="token comment">// for each row.</span>
<span class="token keyword">const</span> oldPeople <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withGraphFetched</span><span class="token punctuation">(</span><span class="token string">'children.children.movies'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
  <span class="token string">&quot;some old person's grand child has appeared in&quot;</span><span class="token punctuation">,</span>
  oldPeople<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>movies<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
  <span class="token string">'movies'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Insert models to the database:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> sylvester <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  firstName<span class="token operator">:</span> <span class="token string">'Sylvester'</span><span class="token punctuation">,</span>
  lastName<span class="token operator">:</span> <span class="token string">'Stallone'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sylvester<span class="token punctuation">.</span><span class="token function">fullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// --&gt; 'Sylvester Stallone'.</span>

<span class="token comment">// Batch insert. This only works on Postgresql as it is</span>
<span class="token comment">// the only database that returns the identifiers of</span>
<span class="token comment">// _all_ inserted rows. If you need to do batch inserts</span>
<span class="token comment">// on other databases useknex* directly.</span>
<span class="token comment">// (See .knexQuery() method).</span>
<span class="token keyword">const</span> inserted <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> firstName<span class="token operator">:</span> <span class="token string">'Arnold'</span><span class="token punctuation">,</span> lastName<span class="token operator">:</span> <span class="token string">'Schwarzenegger'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> firstName<span class="token operator">:</span> <span class="token string">'Sylvester'</span><span class="token punctuation">,</span> lastName<span class="token operator">:</span> <span class="token string">'Stallone'</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>inserted<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">fullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 'Arnold Schwarzenegger'</span>
</code></pre></div><p><code>update</code> and <code>patch</code> can be used to update models. Only difference between the mentioned methods is that <code>update</code> validates the input objects using the model class's full jsonSchema and <code>patch</code> ignores the <code>required</code> property of the schema. Use <code>update</code> when you want to update <em>all</em> properties of a model and <code>patch</code> when only a subset should be updated.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> numUpdatedRows <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> firstName<span class="token operator">:</span> <span class="token string">'Jennifer'</span><span class="token punctuation">,</span> lastName<span class="token operator">:</span> <span class="token string">'Lawrence'</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">35</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> jennifer<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>numUpdatedRows<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// This will throw assuming that `firstName` or `lastName`</span>
<span class="token comment">// is a required property for a Person.</span>
<span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// This will _not_ throw.</span>
<span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Everyone is now 100 years old'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Models can be deleted using the delete method. Naturally the delete query can be chained with any knex* methods:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'anyone over 90 is now removed from the database'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-relatedquery"><a href="#static-relatedquery" class="header-anchor">#</a> <code>static</code> relatedQuery()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> queryBuilder <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span>relationName<span class="token punctuation">,</span> transactionOrKnex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates a query builder that can be used to query a relation of an item (or items).</p> <p>This method is best explained through examples. See the examples below and the following sections:</p> <ul><li><a href="/objection.js/guide/query-examples.html#relation-queries">relation queries</a></li> <li><a href="/objection.js/recipes/relation-subqueries.html">relation subqueries recipe</a></li></ul> <h5 id="arguments-2"><a href="#arguments-2" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>relationName</td> <td>string</td> <td>The name of the relation to query.</td></tr> <tr><td>transactionOrKnex</td> <td>object</td> <td>Optional transaction or knex instance for the query. This can be used to specify a transaction or even a different database for a query. Falsy values are ignored.</td></tr></tbody></table> <h5 id="return-value-2"><a href="#return-value-2" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/">QueryBuilder</a></td> <td>The created query builder</td></tr></tbody></table> <h5 id="examples-2"><a href="#examples-2" class="header-anchor">#</a> Examples</h5> <p>This example fetches <code>pets</code> for a person with id 1. <code>pets</code> is the name of the relation defined in <a href="/objection.js/api/model/static-properties.html#static-relationmappings">relationMappings</a>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> personId <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> pets <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'pets'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span>personId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token string">&quot;animals&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&quot;animals&quot;</span>
<span class="token keyword">where</span> <span class="token string">&quot;animals&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;ownerId&quot;</span> <span class="token operator">=</span> <span class="token number">1</span>
</code></pre></div><p>Just like to any query, you can chain any methods. The following example only fetches dogs and sorts them by name:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'pets'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'species'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token string">&quot;animals&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&quot;animals&quot;</span>
<span class="token keyword">where</span> <span class="token string">&quot;species&quot;</span> <span class="token operator">=</span> <span class="token string">'dog'</span>
<span class="token operator">and</span> <span class="token string">&quot;animals&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;ownerId&quot;</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token string">&quot;name&quot;</span> <span class="token keyword">asc</span>
</code></pre></div><p>If you want to fetch dogs of multiple people in one query, you can pass an array of identifiers to the <a href="/objection.js/api/query-builder/other-methods.html#for">for</a> method like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> dogs <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'pets'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'species'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token string">&quot;animals&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&quot;animals&quot;</span>
<span class="token keyword">where</span> <span class="token string">&quot;species&quot;</span> <span class="token operator">=</span> <span class="token string">'dog'</span>
<span class="token operator">and</span> <span class="token string">&quot;animals&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;ownerId&quot;</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token string">&quot;name&quot;</span> <span class="token keyword">asc</span>
</code></pre></div><p>You can even give it a subquery! The following example fetches all dogs of all people named Jennifer.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Note that there is no `await` here. This query does not get executed.</span>
<span class="token keyword">const</span> jennifers <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'Jennifer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// This is the only executed query in this example.</span>
<span class="token keyword">const</span> allDogsOfAllJennifers <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'pets'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span>jennifers<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'species'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token string">&quot;animals&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&quot;animals&quot;</span>
<span class="token keyword">where</span> <span class="token string">&quot;species&quot;</span> <span class="token operator">=</span> <span class="token string">'dog'</span>
<span class="token operator">and</span> <span class="token string">&quot;animals&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;ownerId&quot;</span> <span class="token operator">in</span> <span class="token punctuation">(</span>
  <span class="token keyword">select</span> <span class="token string">&quot;persons&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;id&quot;</span>
  <span class="token keyword">from</span> <span class="token string">&quot;persons&quot;</span>
  <span class="token keyword">where</span> <span class="token string">&quot;name&quot;</span> <span class="token operator">=</span> <span class="token string">'Jennifer'</span>
<span class="token punctuation">)</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token string">&quot;name&quot;</span> <span class="token keyword">asc</span>
</code></pre></div><p><code>relatedQuery</code> also works with <code>relate</code> , <code>unrelate</code>, <code>delete</code> and all other query methods. The following example relates a person with id 100 to a movie with id 200 for the many-to-many relation <code>movies</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'movies'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">relate</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token string">&quot;persons_movies&quot;</span> <span class="token punctuation">(</span><span class="token string">&quot;personId&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;movieId&quot;</span><span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>
</code></pre></div><p>See more examples <a href="/objection.js/guide/query-examples.html#relation-queries">here</a>.</p> <p><code>relatedQuery</code> can also be used as a subquery when <code>for</code> is omitted. The next example selects the count of a relation and the maximum value of another one:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token string">'persons.*'</span><span class="token punctuation">,</span>

  Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'pets'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'species'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">'dogCount'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'movies'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token string">'createdAt'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">as</span><span class="token punctuation">(</span><span class="token string">'mostRecentMovieDate'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dogCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mostRecentMovieDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Find models that have at least one item in a relation:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> peopleThatHavePets <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">whereExists</span><span class="token punctuation">(</span>
  Person<span class="token punctuation">.</span><span class="token function">relatedQuery</span><span class="token punctuation">(</span><span class="token string">'pets'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Generates something like this:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token string">&quot;persons&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token string">&quot;persons&quot;</span>
<span class="token keyword">where</span> <span class="token keyword">exists</span> <span class="token punctuation">(</span>
  <span class="token keyword">select</span> <span class="token string">&quot;pets&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span>
  <span class="token keyword">from</span> <span class="token string">&quot;animals&quot;</span> <span class="token keyword">as</span> <span class="token string">&quot;pets&quot;</span>
  <span class="token keyword">where</span> <span class="token string">&quot;pets&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;ownerId&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;persons&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;id&quot;</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="static-knex"><a href="#static-knex" class="header-anchor">#</a> <code>static</code> knex()</h2> <p>Get/Set the knex instance for a model class.</p> <p>Subclasses inherit the connection. A system-wide knex instance can thus be set by calling <code>objection.Model.knex(knex)</code>. This works even after subclasses have been created.</p> <p>If you want to use multiple databases, you can instead pass the knex instance to each individual query or use the <a href="/objection.js/api/model/static-methods.html#static-bindknex">bindKnex</a> method.</p> <h5 id="examples-3"><a href="#examples-3" class="header-anchor">#</a> Examples</h5> <p>Set a knex instance:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> knex <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'knex'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  client<span class="token operator">:</span> <span class="token string">'sqlite3'</span><span class="token punctuation">,</span>
  connection<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'database.db'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Model<span class="token punctuation">.</span><span class="token function">knex</span><span class="token punctuation">(</span>knex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Get the knex instance:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> knex <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">knex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-transaction"><a href="#static-transaction" class="header-anchor">#</a> <code>static</code> transaction()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span>trxOrKnex<span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Shortcut for <code>Person.knex().transaction(callback)</code>.</p> <p>See the <a href="/objection.js/guide/transactions.html">transaction guide</a>.</p> <h5 id="arguments-3"><a href="#arguments-3" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>callback</td> <td>function</td> <td></td></tr> <tr><td>trxOrKnex</td> <td>knex or Transation</td> <td>Optional existing transaction or knex instance.</td></tr></tbody></table> <h5 id="examples-4"><a href="#examples-4" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> scrappy <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">trx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> jennifer <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>trx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      firstName<span class="token operator">:</span> <span class="token string">'Jennifer'</span><span class="token punctuation">,</span>
      lastName<span class="token operator">:</span> <span class="token string">'Lawrence'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> scrappy <span class="token operator">=</span> <span class="token keyword">await</span> jennifer
      <span class="token punctuation">.</span><span class="token function">$relatedQuery</span><span class="token punctuation">(</span><span class="token string">'pets'</span><span class="token punctuation">,</span> trx<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Scrappy'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> scrappy<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Great success! Both Jennifer and Scrappy were inserted'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    <span class="token string">'Something went wrong. Neither Jennifer nor Scrappy were inserted'</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="static-starttransaction"><a href="#static-starttransaction" class="header-anchor">#</a> <code>static</code> startTransaction()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> trx <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">startTransaction</span><span class="token punctuation">(</span>trxOrKnex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Shortcut for <code>objection.transaction.start(Model1.knex())</code>.</p> <p>See the <a href="/objection.js/guide/transactions.html">transaction guide</a>.</p> <h5 id="arguments-4"><a href="#arguments-4" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>trxOrKnex</td> <td>knex or Transation</td> <td>Optional existing transaction or knex instance.</td></tr></tbody></table> <h5 id="examples-5"><a href="#examples-5" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> trx <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">startTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>trx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>trx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>trx<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span>person3<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> person3<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> trx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> trx<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="static-beforefind"><a href="#static-beforefind" class="header-anchor">#</a> <code>static</code> beforeFind()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">beforeFind</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A hook that is executed before find queries.</p> <p>See these sections for more information:</p> <ul><li><a href="/objection.js/guide/hooks.html#static-query-hooks">static hooks guide</a></li> <li><a href="/objection.js/api/types/#type-statichookarguments">documentation for the arguments</a></li></ul> <h5 id="arguments-5"><a href="#arguments-5" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>args</td> <td><a href="/objection.js/api/types/#type-statichookarguments">StaticHookArguments</a></td> <td>The arguments</td></tr></tbody></table> <h5 id="return-value-3"><a href="#return-value-3" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>any</td> <td>The return value is not used.</td></tr></tbody></table> <h2 id="static-afterfind"><a href="#static-afterfind" class="header-anchor">#</a> <code>static</code> afterFind()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">afterFind</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A hook that is executed after find queries.</p> <p>See these sections for more information:</p> <ul><li><a href="/objection.js/guide/hooks.html#static-query-hooks">static hooks guide</a></li> <li><a href="/objection.js/api/types/#type-statichookarguments">documentation for the arguments</a></li></ul> <h5 id="arguments-6"><a href="#arguments-6" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>args</td> <td><a href="/objection.js/api/types/#type-statichookarguments">StaticHookArguments</a></td> <td>The arguments</td></tr></tbody></table> <h5 id="return-value-4"><a href="#return-value-4" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>any</td> <td>If the return value is not <code>undefined</code>, it will be used as the return value of the query.</td></tr></tbody></table> <h2 id="static-beforeupdate"><a href="#static-beforeupdate" class="header-anchor">#</a> <code>static</code> beforeUpdate()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">beforeUpdate</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A hook that is executed before update and patch queries.</p> <p>See these sections for more information:</p> <ul><li><a href="/objection.js/guide/hooks.html#static-query-hooks">static hooks guide</a></li> <li><a href="/objection.js/api/types/#type-statichookarguments">documentation for the arguments</a></li></ul> <h5 id="arguments-7"><a href="#arguments-7" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>args</td> <td><a href="/objection.js/api/types/#type-statichookarguments">StaticHookArguments</a></td> <td>The arguments</td></tr></tbody></table> <h5 id="return-value-5"><a href="#return-value-5" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>any</td> <td>The return value is not used.</td></tr></tbody></table> <h2 id="static-afterupdate"><a href="#static-afterupdate" class="header-anchor">#</a> <code>static</code> afterUpdate()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">afterUpdate</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A hook that is executed after update and patch queries.</p> <p>See these sections for more information:</p> <ul><li><a href="/objection.js/guide/hooks.html#static-query-hooks">static hooks guide</a></li> <li><a href="/objection.js/api/types/#type-statichookarguments">documentation for the arguments</a></li></ul> <h5 id="arguments-8"><a href="#arguments-8" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>args</td> <td><a href="/objection.js/api/types/#type-statichookarguments">StaticHookArguments</a></td> <td>The arguments</td></tr></tbody></table> <h5 id="return-value-6"><a href="#return-value-6" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>any</td> <td>If the return value is not <code>undefined</code>, it will be used as the return value of the query.</td></tr></tbody></table> <h2 id="static-beforeinsert"><a href="#static-beforeinsert" class="header-anchor">#</a> <code>static</code> beforeInsert()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">beforeInsert</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A hook that is executed before insert queries.</p> <p>See these sections for more information:</p> <ul><li><a href="/objection.js/guide/hooks.html#static-query-hooks">static hooks guide</a></li> <li><a href="/objection.js/api/types/#type-statichookarguments">documentation for the arguments</a></li></ul> <h5 id="arguments-9"><a href="#arguments-9" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>args</td> <td><a href="/objection.js/api/types/#type-statichookarguments">StaticHookArguments</a></td> <td>The arguments</td></tr></tbody></table> <h5 id="return-value-7"><a href="#return-value-7" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>any</td> <td>The return value is not used.</td></tr></tbody></table> <h2 id="static-afterinsert"><a href="#static-afterinsert" class="header-anchor">#</a> <code>static</code> afterInsert()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">afterInsert</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A hook that is executed after insert queries.</p> <p>See these sections for more information:</p> <ul><li><a href="/objection.js/guide/hooks.html#static-query-hooks">static hooks guide</a></li> <li><a href="/objection.js/api/types/#type-statichookarguments">documentation for the arguments</a></li></ul> <h5 id="arguments-10"><a href="#arguments-10" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>args</td> <td><a href="/objection.js/api/types/#type-statichookarguments">StaticHookArguments</a></td> <td>The arguments</td></tr></tbody></table> <h5 id="return-value-8"><a href="#return-value-8" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>any</td> <td>If the return value is not <code>undefined</code>, it will be used as the return value of the query.</td></tr></tbody></table> <h2 id="static-beforedelete"><a href="#static-beforedelete" class="header-anchor">#</a> <code>static</code> beforeDelete()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">beforeDelete</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A hook that is executed before delete queries.</p> <p>See these sections for more information:</p> <ul><li><a href="/objection.js/guide/hooks.html#static-query-hooks">static hooks guide</a></li> <li><a href="/objection.js/api/types/#type-statichookarguments">documentation for the arguments</a></li></ul> <h5 id="arguments-11"><a href="#arguments-11" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>args</td> <td><a href="/objection.js/api/types/#type-statichookarguments">StaticHookArguments</a></td> <td>The arguments</td></tr></tbody></table> <h5 id="return-value-9"><a href="#return-value-9" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>any</td> <td>The return value is not used.</td></tr></tbody></table> <h2 id="static-afterdelete"><a href="#static-afterdelete" class="header-anchor">#</a> <code>static</code> afterDelete()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">afterDelete</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>A hook that is executed after delete queries.</p> <p>See these sections for more information:</p> <ul><li><a href="/objection.js/guide/hooks.html#static-query-hooks">static hooks guide</a></li> <li><a href="/objection.js/api/types/#type-statichookarguments">documentation for the arguments</a></li></ul> <h5 id="arguments-12"><a href="#arguments-12" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>args</td> <td><a href="/objection.js/api/types/#type-statichookarguments">StaticHookArguments</a></td> <td>The arguments</td></tr></tbody></table> <h5 id="return-value-10"><a href="#return-value-10" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>any</td> <td>If the return value is not <code>undefined</code>, it will be used as the return value of the query.</td></tr></tbody></table> <h2 id="static-bindknex"><a href="#static-bindknex" class="header-anchor">#</a> <code>static</code> bindKnex()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> BoundPerson <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">bindKnex</span><span class="token punctuation">(</span>transactionOrKnex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates an anonymous model subclass class that is bound to the given knex instance or transaction.</p> <p>This method can be used to bind a Model subclass to multiple databases for example in a multi-tenant system. See the <a href="/objection.js/recipes/multitenancy-using-multiple-databases.html">multi tenancy recipe</a> for more info.</p> <p>Also check out the <a href="/objection.js/guide/transactions.html#binding-models-to-a-transaction">model binding pattern for transactions</a> which internally uses <code>bindKnex</code>.</p> <h5 id="arguments-13"><a href="#arguments-13" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>transactionOrKnex</td> <td>object</td> <td>knex instance or a transaction to bind the model to.</td></tr></tbody></table> <h5 id="return-value-11"><a href="#return-value-11" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>Constructor&lt;? extends Model&gt;</td> <td>The created model subclass constructor</td></tr></tbody></table> <h5 id="examples-6"><a href="#examples-6" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> knex1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'knex'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  client<span class="token operator">:</span> <span class="token string">'sqlite3'</span><span class="token punctuation">,</span>
  connection<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'database1.db'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> knex2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'knex'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  client<span class="token operator">:</span> <span class="token string">'sqlite3'</span><span class="token punctuation">,</span>
  connection<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'database2.db'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

SomeModel<span class="token punctuation">.</span><span class="token function">knex</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> BoundModel1 <span class="token operator">=</span> SomeModel<span class="token punctuation">.</span><span class="token function">bindKnex</span><span class="token punctuation">(</span>knex1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> BoundModel2 <span class="token operator">=</span> SomeModel<span class="token punctuation">.</span><span class="token function">bindKnex</span><span class="token punctuation">(</span>knex2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Throws since the knex instance is null.</span>
<span class="token keyword">await</span> SomeModel<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Works.</span>
<span class="token keyword">const</span> models <span class="token operator">=</span> <span class="token keyword">await</span> BoundModel1<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>models<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">SomeModel</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>models<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">BoundModel1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; true</span>

<span class="token comment">// Works.</span>
<span class="token keyword">const</span> models <span class="token operator">=</span> <span class="token keyword">await</span> BoundModel2<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>models<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">SomeModel</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>models<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">BoundModel2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; true</span>
</code></pre></div><h2 id="static-bindtransaction"><a href="#static-bindtransaction" class="header-anchor">#</a> <code>static</code> bindTransaction()</h2> <p>Alias for <a href="/objection.js/api/model/static-methods.html#static-bindknex">bindKnex</a>.</p> <h5 id="examples-7"><a href="#examples-7" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> transaction <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'objection'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Person <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./models/Person'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> <span class="token function">transaction</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span><span class="token function">knex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">trx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> TransactingPerson <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">bindTransaction</span><span class="token punctuation">(</span>trx<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">await</span> TransactingPerson<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> firstName<span class="token operator">:</span> <span class="token string">'Jennifer'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> TransactingPerson<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> lastName<span class="token operator">:</span> <span class="token string">'Lawrence'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> jennifer<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This is 100% equivalent to the example above:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> transaction <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'objection'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Person <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./models/Person'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> <span class="token function">transaction</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">TransactingPerson</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> TransactingPerson<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span> firstName<span class="token operator">:</span> <span class="token string">'Jennifer'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> TransactingPerson<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> lastName<span class="token operator">:</span> <span class="token string">'Lawrence'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> jennifer<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-fromjson"><a href="#static-fromjson" class="header-anchor">#</a> <code>static</code> fromJson()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates a model instance from a POJO (Plain Old Javascript Object).</p> <p>The object is checked against <a href="/objection.js/api/model/static-properties.html#static-jsonschema">jsonSchema</a> if a schema is provided and an exception is thrown on failure.</p> <p>The <code>json</code> object is also passed through the <a href="/objection.js/api/model/instance-methods.html#parsejson">$parseJson</a> hook before the model instance is created. See <a href="/objection.js/api/model/overview.html#model-data-lifecycle">this section</a> for more info.</p> <h5 id="arguments-14"><a href="#arguments-14" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>json</td> <td>Object</td> <td>The JSON object from which to create the model.</td></tr> <tr><td>opt</td> <td><a href="/objection.js/api/types/#type-modeloptions">ModelOptions</a></td> <td>Update options.</td></tr></tbody></table> <h5 id="return-value-12"><a href="#return-value-12" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/model/" class="router-link-active">Model</a></td> <td>The created model instance</td></tr></tbody></table> <h5 id="examples-8"><a href="#examples-8" class="header-anchor">#</a> Examples</h5> <p>Create a model instance:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> jennifer <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span><span class="token punctuation">{</span> firstName<span class="token operator">:</span> <span class="token string">'Jennifer'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Create a model instance skipping validation:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> jennifer <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> firstName<span class="token operator">:</span> <span class="token string">'Jennifer'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> skipValidation<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-fromdatabasejson"><a href="#static-fromdatabasejson" class="header-anchor">#</a> <code>static</code> fromDatabaseJson()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">fromDatabaseJson</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Creates a model instance from a JSON object send by the database driver.</p> <p>Unlike <a href="/objection.js/api/model/static-methods.html#static-fromjson">fromJson</a>, this method doesn't validate the input. The input is expected to be in the database format as explained <a href="/objection.js/api/model/overview.html#model-data-lifecycle">here</a>.</p> <h5 id="arguments-15"><a href="#arguments-15" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>row</td> <td>Object</td> <td>A database row.</td></tr></tbody></table> <h5 id="return-value-13"><a href="#return-value-13" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/model/" class="router-link-active">Model</a></td> <td>The created model instance</td></tr></tbody></table> <h2 id="static-modifiernotfound"><a href="#static-modifiernotfound" class="header-anchor">#</a> <code>static</code> modifierNotFound()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">BaseModel</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">modifierNotFound</span><span class="token punctuation">(</span><span class="token parameter">builder<span class="token punctuation">,</span> modifier</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> properties <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>jsonSchema<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>properties <span class="token operator">&amp;&amp;</span> modifier <span class="token keyword">in</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      builder<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>modifier<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">modifierNotFound</span><span class="token punctuation">(</span>builder<span class="token punctuation">,</span> modifier<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This method is called when an unknown modifier is used somewhere.</p> <p>By default, the static <code>modifierNotFound()</code> hook throws a <code>ModifierNotFoundError</code> error. If a model class overrides the hook, it can decide to handle the modifer through the passed <code>builder</code> instance, or call the hook's definition in the super class to still throw the error.</p> <h5 id="arguments-16"><a href="#arguments-16" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>builder</td> <td><a href="/objection.js/api/query-builder/">QueryBuilder</a></td> <td>The query builder on which to apply the modifier.</td></tr> <tr><td>modifier</td> <td>string</td> <td>The name of the unknown modifier.</td></tr></tbody></table> <h2 id="static-createvalidator"><a href="#static-createvalidator" class="header-anchor">#</a> <code>static</code> createValidator()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">BaseModel</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyCustomValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Creates an instance of a <a href="/objection.js/api/types/#class-validator">Validator</a> that is used to do all validation related stuff. This method is called only once per model class.</p> <p>You can override this method to return an instance of your custom validator. The custom validator doesn't need to be based on the <code>jsonSchema</code>. It can be anything at all as long as it implements the <a href="/objection.js/api/types/#class-validator">Validator</a> interface.</p> <p>If you want to use the default json schema based <a href="/objection.js/api/types/#class-ajvvalidator">AjvValidator</a> but want to modify it, you can use the <code>objection.AjvValidator</code> constructor. See the default implementation example.</p> <p>If you want to share the same validator instance between multiple models, that's completely fine too. Simply implement <code>createValidator</code> so that it always returns the same object instead of creating a new one.</p> <h5 id="examples-9"><a href="#examples-9" class="header-anchor">#</a> Examples</h5> <p>Sharing the same validator between model classes is also possible:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> validator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyCustomValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">BaseModel</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> validator<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The default implementation:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> AjvValidator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'objection'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AjvValidator<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AjvValidator</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">onCreateAjv</span><span class="token operator">:</span> <span class="token parameter">ajv</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// Here you can modify the `Ajv` instance.</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        allErrors<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        validateSchema<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        ownProperties<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        v5<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="static-createnotfounderror"><a href="#static-createnotfounderror" class="header-anchor">#</a> <code>static</code> createNotFoundError()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">BaseModel</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createNotFoundError</span><span class="token punctuation">(</span><span class="token parameter">queryContext<span class="token punctuation">,</span> props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyCustomNotFoundError</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>props<span class="token punctuation">,</span> modelClass<span class="token operator">:</span> <span class="token keyword">this</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Creates an error thrown by <a href="/objection.js/api/query-builder/other-methods.html#throwifnotfound">throwIfNotFound</a> method. You can override this
to throw any error you want.</p> <h5 id="arguments-17"><a href="#arguments-17" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>queryContext</td> <td>Object</td> <td>The context object of query that produced the empty result. See <a href="/objection.js/api/query-builder/other-methods.html#context">context</a>.</td></tr> <tr><td>props</td> <td>any</td> <td>Data passed to the error class constructor.</td></tr></tbody></table> <h5 id="return-value-14"><a href="#return-value-14" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Error</code></td> <td>The created error. <a href="/objection.js/api/types/#class-notfounderror">NotFoundError</a> by default.</td></tr></tbody></table> <h5 id="examples-10"><a href="#examples-10" class="header-anchor">#</a> Examples</h5> <p>The default implementation:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createNotFoundError</span><span class="token punctuation">(</span><span class="token parameter">queryContext<span class="token punctuation">,</span> props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">this<span class="token punctuation">.</span>NotFoundError</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>props<span class="token punctuation">,</span> modelClass<span class="token operator">:</span> <span class="token keyword">this</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="static-createvalidationerror"><a href="#static-createvalidationerror" class="header-anchor">#</a> <code>static</code> createValidationError()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">BaseModel</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createValidationError</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> type<span class="token punctuation">,</span> message<span class="token punctuation">,</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyCustomValidationError</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">,</span> message<span class="token punctuation">,</span> data<span class="token punctuation">,</span> modelClass<span class="token operator">:</span> <span class="token keyword">this</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Creates an error thrown when validation fails for a model. You can override this to throw any error you want. The errors created by this function don't have to implement any interface or have the same properties as <code>ValidationError</code>. Objection only throws errors created by this function an never catches them.</p> <h5 id="return-value-15"><a href="#return-value-15" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Error</code></td> <td>The created error. <a href="/objection.js/api/types/#class-validationerror">ValidationError</a> by default.</td></tr></tbody></table> <h2 id="static-fetchgraph"><a href="#static-fetchgraph" class="header-anchor">#</a> <code>static</code> fetchGraph()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> queryBuilder <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">fetchGraph</span><span class="token punctuation">(</span>models<span class="token punctuation">,</span> expression<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Load related models for a set of models using a <a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a>.</p> <h5 id="arguments-18"><a href="#arguments-18" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>models</td> <td>Array&lt;<a href="/objection.js/api/model/" class="router-link-active">Model</a>|Object&gt;</td> <td>Model instances for which to fetch the relations. Can be an array of model instances, array of POJOs, a single model instance or a single POJO.</td></tr> <tr><td>expression</td> <td>string|<a href="/objection.js/api/types/#type-relationexpression">RelationExpression</a></td> <td>The relation expression</td></tr> <tr><td>options</td> <td><a href="/objection.js/api/types/#type-fetchgraphoptions">FetchGraphOptions</a></td> <td>Optional options.</td></tr></tbody></table> <h5 id="return-value-16"><a href="#return-value-16" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/query-builder/">QueryBuilder</a></td> <td>The created query builder</td></tr></tbody></table> <h5 id="examples-11"><a href="#examples-11" class="header-anchor">#</a> Examples</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">fetchGraph</span><span class="token punctuation">(</span><span class="token punctuation">[</span>person1<span class="token punctuation">,</span> person2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'children.pets'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> person1 <span class="token operator">=</span> people<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> person2 <span class="token operator">=</span> people<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>Relations can be filtered by giving modifier functions as arguments for the relations:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">fetchGraph</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>person1<span class="token punctuation">,</span> person2<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    children(orderByAge).[
      pets(onlyDogs, orderByName),
      movies
    ]
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">modifiers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">orderByAge</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">orderByName</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">onlyDogs</span><span class="token punctuation">(</span><span class="token parameter">builder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'species'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>people<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>children<span class="token punctuation">.</span>pets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-traverseasync"><a href="#static-traverseasync" class="header-anchor">#</a> <code>static</code> traverseAsync()</h2> <p>Traverses the relation tree of a model instance (or a list of model instances).</p> <p>Calls the callback for each related model recursively. The callback is called also for the input models themselves.</p> <p>In the second example the traverser function is only called for <code>Person</code> instances.</p> <h5 id="arguments-19"><a href="#arguments-19" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>filterConstructor</td> <td>function</td> <td>If this optional constructor is given, the <code>traverser</code> is only called for models for which <code>model instanceof filterConstructor</code> returns true.</td></tr> <tr><td>models</td> <td><a href="/objection.js/api/model/" class="router-link-active">Model</a>|<a href="/objection.js/api/model/" class="router-link-active">Model</a>[]</td> <td>The model(s) whose relation trees to traverse.</td></tr> <tr><td>traverser</td> <td>function(<a href="/objection.js/api/model/" class="router-link-active">Model</a>, string, string)</td> <td>The traverser function that is called for each model. The first argument is the model itself. If the model is in a relation of some other model the second argument is the parent model and the third argument is the name of the relation.</td></tr></tbody></table> <h5 id="examples-12"><a href="#examples-12" class="header-anchor">#</a> Examples</h5> <p>There are two ways to call this method:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> models <span class="token operator">=</span> <span class="token keyword">await</span> SomeModel<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> Model<span class="token punctuation">.</span><span class="token function">traverseAsync</span><span class="token punctuation">(</span>models<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">model<span class="token punctuation">,</span> parentModel<span class="token punctuation">,</span> relationName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">doSomething</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>and</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> persons <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Model<span class="token punctuation">.</span><span class="token function">traverseAsync</span><span class="token punctuation">(</span>
  Person<span class="token punctuation">,</span>
  persons<span class="token punctuation">,</span>
  <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">person<span class="token punctuation">,</span> parentModel<span class="token punctuation">,</span> relationName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">doSomethingWithPerson</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Also works with a single model instance</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">traverseAsync</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">model<span class="token punctuation">,</span> parentModel<span class="token punctuation">,</span> relationName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token function">doSomething</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-getrelations"><a href="#static-getrelations" class="header-anchor">#</a> <code>static</code> getRelations()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> relations <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">getRelations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Returns a <a href="/objection.js/api/types/#class-relation">Relation</a> object for each relation defined in <a href="/objection.js/api/model/static-properties.html#static-relationmappings">relationMappings</a>.</p> <p>This method is mainly useful for plugin developers and for other generic usages.</p> <h5 id="return-value-17"><a href="#return-value-17" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>Object&lt;string, <a href="/objection.js/api/types/#class-relation">Relation</a>&gt;</td> <td>Object whose keys are relation names and values are <a href="/objection.js/api/types/#class-relation">Relation</a> instances.</td></tr></tbody></table> <h2 id="static-columnnametopropertyname"><a href="#static-columnnametopropertyname" class="header-anchor">#</a> <code>static</code> columnNameToPropertyName()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> propertyName <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">columnNameToPropertyName</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Runs the property through possible <code>columnNameMappers</code> and <code>$parseDatabaseJson</code> hooks to apply any possible conversion for the column name.</p> <h5 id="arguments-20"><a href="#arguments-20" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>columnName</td> <td>string</td> <td>A column name</td></tr></tbody></table> <h5 id="return-value-18"><a href="#return-value-18" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>string</td> <td>The property name</td></tr></tbody></table> <h5 id="examples-13"><a href="#examples-13" class="header-anchor">#</a> Examples</h5> <p>If you have defined <code>columnNameMappers = snakeCaseMappers()</code> for your model:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> propName <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">columnNameToPropertyName</span><span class="token punctuation">(</span><span class="token string">'foo_bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>propName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 'fooBar'</span>
</code></pre></div><h2 id="static-propertynametocolumnname"><a href="#static-propertynametocolumnname" class="header-anchor">#</a> <code>static</code> propertyNameToColumnName()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> columnName <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">propertyNameToColumnName</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Runs the property through possible <code>columnNameMappers</code> and <code>$formatDatabaseJson</code> hooks to apply any possible conversion for the property name.</p> <h5 id="arguments-21"><a href="#arguments-21" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>propertyName</td> <td>string</td> <td>A property name</td></tr></tbody></table> <h5 id="return-value-19"><a href="#return-value-19" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>string</td> <td>The column name</td></tr></tbody></table> <h5 id="examples-14"><a href="#examples-14" class="header-anchor">#</a> Examples</h5> <p>If you have defined <code>columnNameMappers = snakeCaseMappers()</code> for your model:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> columnName <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">propertyNameToColumnName</span><span class="token punctuation">(</span><span class="token string">'fooBar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// --&gt; 'foo_bar'</span>
</code></pre></div><h2 id="static-fetchtablemetadata"><a href="#static-fetchtablemetadata" class="header-anchor">#</a> <code>static</code> fetchTableMetadata()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> metadata <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">fetchTableMetadata</span><span class="token punctuation">(</span>opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Fetches and caches the table metadata.</p> <p>Most of the time objection doesn't need this metadata, but some methods like <a href="/objection.js/api/query-builder/eager-methods.html#withgraphjoined">withGraphJoined</a> do. This method is called by objection when the metadata is needed. The result is cached and after the first call the cached promise is returned and no queries are executed.</p> <p>Because objection uses this on demand, the first query that needs this information can have unpredicable performance. If that's a problem, you can call this method for each of your models during your app's startup.</p> <p>If you've implemented <a href="/objection.js/api/model/static-methods.html#static-tablemetadata">tableMetadata</a> method to return a custom metadata object, this method doesn't execute database queries, but returns <code>Promise.resolve(this.tableMetadata())</code> instead.</p> <h5 id="arguments-22"><a href="#arguments-22" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>opt</td> <td><a href="/objection.js/api/types/#type-tablemetadatafetchoptions">TableMetadataFetchOptions</a></td> <td>Optional options</td></tr></tbody></table> <h5 id="return-value-20"><a href="#return-value-20" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>Promise&lt;<a href="/objection.js/api/types/#type-tablemetadata">TableMetadata</a>&gt;</td> <td>The table metadata object</td></tr></tbody></table> <h2 id="static-tablemetadata"><a href="#static-tablemetadata" class="header-anchor">#</a> <code>static</code> tableMetadata()</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> metadata <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">tableMetadata</span><span class="token punctuation">(</span>opt<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Synchronously returns the table metadata object from the cache.</p> <p>You can override this method to return a custom object if you don't want objection to use
<a href="/objection.js/api/model/static-methods.html#static-fetchtablemetadata">fetchTableMetadata</a>.</p> <p>See <a href="/objection.js/api/model/static-methods.html#static-fetchtablemetadata">fetchTableMetadata</a> for more information.</p> <h5 id="arguments-23"><a href="#arguments-23" class="header-anchor">#</a> Arguments</h5> <table><thead><tr><th>Argument</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>opt</td> <td><a href="/objection.js/api/types/#type-tablemetadataoptions">TableMetadataOptions</a></td> <td>Optional options</td></tr></tbody></table> <h5 id="return-value-21"><a href="#return-value-21" class="header-anchor">#</a> Return value</h5> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><a href="/objection.js/api/types/#type-tablemetadata">TableMetadata</a></td> <td>The table metadata object</td></tr></tbody></table> <h5 id="examples-15"><a href="#examples-15" class="header-anchor">#</a> Examples</h5> <p>A custom override that uses the property information in <code>jsonSchema</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">tableMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      columns<span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>jsonSchema<span class="token punctuation">.</span>properties<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="static-raw"><a href="#static-raw" class="header-anchor">#</a> <code>static</code> raw()</h2> <p>Shortcut for <code>Person.knex().raw(...args)</code></p> <h2 id="static-ref"><a href="#static-ref" class="header-anchor">#</a> <code>static</code> ref()</h2> <p>Returns a <a href="/objection.js/api/types/#class-referencebuilder">ReferenceBuilder</a> instance that is bound to the model class. Any reference created using it will add the correct table name to the reference.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token operator">=</span> Person<span class="token punctuation">;</span>
<span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Jennifer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token string">&quot;persons&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&quot;persons&quot;</span> <span class="token keyword">where</span> <span class="token string">&quot;persons&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;firstName&quot;</span> <span class="token operator">=</span> <span class="token string">'Jennifer'</span>
</code></pre></div><p><code>ref</code> uses the correct table name even when an alias has been given to the table.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token operator">=</span> Person<span class="token punctuation">;</span>
<span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Jennifer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token string">&quot;p&quot;</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">&quot;persons&quot;</span> <span class="token keyword">as</span> <span class="token string">&quot;p&quot;</span> <span class="token keyword">where</span> <span class="token string">&quot;p&quot;</span><span class="token punctuation">.</span><span class="token string">&quot;firstName&quot;</span> <span class="token operator">=</span> <span class="token string">'Jennifer'</span>
</code></pre></div><p>Note that the following two ways to use <code>Model.ref</code> are completely equivalent:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token operator">=</span> Person<span class="token punctuation">;</span>
<span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Jennifer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Jennifer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="static-fn"><a href="#static-fn" class="header-anchor">#</a> <code>static</code> fn()</h2> <p>Shortcut for <code>Person.knex().fn</code></p> <h2 id="static-knexquery"><a href="#static-knexquery" class="header-anchor">#</a> <code>static</code> knexQuery()</h2> <p>Shortcut for <code>Person.knex().table(Person.tableName)</code></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/objection.js/api/model/static-properties.html" class="prev">
        Static Properties
      </a></span> <span class="next"><a href="/objection.js/api/model/instance-methods.html">
        Instance Methods
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/objection.js/assets/js/app.398a341a.js" defer></script><script src="/objection.js/assets/js/6.57603b17.js" defer></script><script src="/objection.js/assets/js/7.76e572ea.js" defer></script><script src="/objection.js/assets/js/17.dbe720da.js" defer></script>
  </body>
</html>
