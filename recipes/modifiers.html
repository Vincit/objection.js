<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Modifiers | Objection.js</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="An SQL friendly ORM for node.js">
    
    <link rel="preload" href="/objection.js/assets/css/0.styles.c14c82cd.css" as="style"><link rel="preload" href="/objection.js/assets/js/app.d04a8ef7.js" as="script"><link rel="preload" href="/objection.js/assets/js/6.16d8453b.js" as="script"><link rel="preload" href="/objection.js/assets/js/7.4cbcc556.js" as="script"><link rel="preload" href="/objection.js/assets/js/47.6ed9f050.js" as="script"><link rel="prefetch" href="/objection.js/assets/js/1.19323e71.js"><link rel="prefetch" href="/objection.js/assets/js/10.ffa64544.js"><link rel="prefetch" href="/objection.js/assets/js/11.d4d6118f.js"><link rel="prefetch" href="/objection.js/assets/js/12.7b6e4621.js"><link rel="prefetch" href="/objection.js/assets/js/13.04ebe08e.js"><link rel="prefetch" href="/objection.js/assets/js/14.47fe39a1.js"><link rel="prefetch" href="/objection.js/assets/js/15.85079d64.js"><link rel="prefetch" href="/objection.js/assets/js/16.48154828.js"><link rel="prefetch" href="/objection.js/assets/js/17.39a8496e.js"><link rel="prefetch" href="/objection.js/assets/js/18.f9d12967.js"><link rel="prefetch" href="/objection.js/assets/js/19.63943aee.js"><link rel="prefetch" href="/objection.js/assets/js/2.d0c72ae2.js"><link rel="prefetch" href="/objection.js/assets/js/20.391739bc.js"><link rel="prefetch" href="/objection.js/assets/js/21.a5b4abbc.js"><link rel="prefetch" href="/objection.js/assets/js/22.cf1b3c14.js"><link rel="prefetch" href="/objection.js/assets/js/23.eb51fbf9.js"><link rel="prefetch" href="/objection.js/assets/js/24.ea9300b0.js"><link rel="prefetch" href="/objection.js/assets/js/25.b0e59d3e.js"><link rel="prefetch" href="/objection.js/assets/js/26.77d247a5.js"><link rel="prefetch" href="/objection.js/assets/js/27.eda41b1d.js"><link rel="prefetch" href="/objection.js/assets/js/28.ac5556e6.js"><link rel="prefetch" href="/objection.js/assets/js/29.c5e189ad.js"><link rel="prefetch" href="/objection.js/assets/js/3.119b426b.js"><link rel="prefetch" href="/objection.js/assets/js/30.8f238cfb.js"><link rel="prefetch" href="/objection.js/assets/js/31.bbcbe243.js"><link rel="prefetch" href="/objection.js/assets/js/32.56d51f7e.js"><link rel="prefetch" href="/objection.js/assets/js/33.fdbd6322.js"><link rel="prefetch" href="/objection.js/assets/js/34.74558ea9.js"><link rel="prefetch" href="/objection.js/assets/js/35.e59d142a.js"><link rel="prefetch" href="/objection.js/assets/js/36.3c02efd2.js"><link rel="prefetch" href="/objection.js/assets/js/37.546ba802.js"><link rel="prefetch" href="/objection.js/assets/js/38.b296b712.js"><link rel="prefetch" href="/objection.js/assets/js/39.3d6bf17e.js"><link rel="prefetch" href="/objection.js/assets/js/40.6de21fbc.js"><link rel="prefetch" href="/objection.js/assets/js/41.77111bb1.js"><link rel="prefetch" href="/objection.js/assets/js/42.306c4b30.js"><link rel="prefetch" href="/objection.js/assets/js/43.d4fb70e0.js"><link rel="prefetch" href="/objection.js/assets/js/44.ce579e25.js"><link rel="prefetch" href="/objection.js/assets/js/45.79b83d16.js"><link rel="prefetch" href="/objection.js/assets/js/46.30fbb41b.js"><link rel="prefetch" href="/objection.js/assets/js/48.ab10654d.js"><link rel="prefetch" href="/objection.js/assets/js/49.7e06c439.js"><link rel="prefetch" href="/objection.js/assets/js/50.b9908b93.js"><link rel="prefetch" href="/objection.js/assets/js/51.40ef19bf.js"><link rel="prefetch" href="/objection.js/assets/js/52.3f06722a.js"><link rel="prefetch" href="/objection.js/assets/js/53.52ea4a3b.js"><link rel="prefetch" href="/objection.js/assets/js/54.028dfb7a.js"><link rel="prefetch" href="/objection.js/assets/js/55.a97034e5.js"><link rel="prefetch" href="/objection.js/assets/js/56.fa52575a.js"><link rel="prefetch" href="/objection.js/assets/js/57.1ace7f1a.js"><link rel="prefetch" href="/objection.js/assets/js/58.59d8b3f4.js"><link rel="prefetch" href="/objection.js/assets/js/59.7a9e2d73.js"><link rel="prefetch" href="/objection.js/assets/js/60.b1fb8be5.js"><link rel="prefetch" href="/objection.js/assets/js/8.49a12594.js"><link rel="prefetch" href="/objection.js/assets/js/9.57632743.js"><link rel="prefetch" href="/objection.js/assets/js/vendors~docsearch.58aff259.js">
    <link rel="stylesheet" href="/objection.js/assets/css/0.styles.c14c82cd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/objection.js/" class="home-link router-link-active"><!----> <span class="site-name">Objection.js</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/objection.js/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API Reference" class="dropdown-title"><span class="title">API Reference</span> <span class="arrow down"></span></button> <button type="button" aria-label="API Reference" class="mobile-dropdown-title"><span class="title">API Reference</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/api/objection/" class="nav-link">
  Main Module
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/query-builder/" class="nav-link">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/model/" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/types/" class="nav-link">
  Types
</a></li></ul></div></div><div class="nav-item"><a href="/objection.js/recipes/" class="nav-link router-link-active">
  Recipe Book
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Release Notes" class="dropdown-title"><span class="title">Release Notes</span> <span class="arrow down"></span></button> <button type="button" aria-label="Release Notes" class="mobile-dropdown-title"><span class="title">Release Notes</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/changelog.html" class="nav-link">
  Changelog
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/migration.html" class="nav-link">
  Migration to 2.0
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Vincit/objection.js/tree/v1/doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐ Star
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/objection.js/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API Reference" class="dropdown-title"><span class="title">API Reference</span> <span class="arrow down"></span></button> <button type="button" aria-label="API Reference" class="mobile-dropdown-title"><span class="title">API Reference</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/api/objection/" class="nav-link">
  Main Module
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/query-builder/" class="nav-link">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/model/" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/api/types/" class="nav-link">
  Types
</a></li></ul></div></div><div class="nav-item"><a href="/objection.js/recipes/" class="nav-link router-link-active">
  Recipe Book
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Release Notes" class="dropdown-title"><span class="title">Release Notes</span> <span class="arrow down"></span></button> <button type="button" aria-label="Release Notes" class="mobile-dropdown-title"><span class="title">Release Notes</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/changelog.html" class="nav-link">
  Changelog
</a></li><li class="dropdown-item"><!----> <a href="/objection.js/release-notes/migration.html" class="nav-link">
  Migration to 2.0
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Vincit/objection.js/tree/v1/doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x documentation
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ⭐ Star
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/vincit/objection.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Recipes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/objection.js/recipes/raw-queries.html" class="sidebar-link">Raw queries</a></li><li><a href="/objection.js/recipes/precedence-and-parentheses.html" class="sidebar-link">Precedence and parentheses</a></li><li><a href="/objection.js/recipes/subqueries.html" class="sidebar-link">Subqueries</a></li><li><a href="/objection.js/recipes/relation-subqueries.html" class="sidebar-link">Relation subqueries</a></li><li><a href="/objection.js/recipes/joins.html" class="sidebar-link">Joins</a></li><li><a href="/objection.js/recipes/modifiers.html" aria-current="page" class="active sidebar-link">Modifiers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/objection.js/recipes/modifiers.html#usage-in-a-query" class="sidebar-link">Usage in a query</a></li><li class="sidebar-sub-header"><a href="/objection.js/recipes/modifiers.html#usage-with-eager-loading" class="sidebar-link">Usage with eager loading</a></li><li class="sidebar-sub-header"><a href="/objection.js/recipes/modifiers.html#usage-in-joinrelated" class="sidebar-link">Usage in joinRelated</a></li><li class="sidebar-sub-header"><a href="/objection.js/recipes/modifiers.html#other-usages" class="sidebar-link">Other usages</a></li><li class="sidebar-sub-header"><a href="/objection.js/recipes/modifiers.html#modifier-best-practices" class="sidebar-link">Modifier best practices</a></li></ul></li><li><a href="/objection.js/recipes/composite-keys.html" class="sidebar-link">Composite keys</a></li><li><a href="/objection.js/recipes/polymorphic-associations.html" class="sidebar-link">Polymorphic associations</a></li><li><a href="/objection.js/recipes/json-queries.html" class="sidebar-link">JSON queries</a></li><li><a href="/objection.js/recipes/custom-id-column.html" class="sidebar-link">Custom id column</a></li><li><a href="/objection.js/recipes/extra-properties.html" class="sidebar-link">Join table extra properties</a></li><li><a href="/objection.js/recipes/custom-validation.html" class="sidebar-link">Custom validation</a></li><li><a href="/objection.js/recipes/snake-case-to-camel-case-conversion.html" class="sidebar-link">Snake case to camel case conversion</a></li><li><a href="/objection.js/recipes/paging.html" class="sidebar-link">Paging</a></li><li><a href="/objection.js/recipes/returning-tricks.html" class="sidebar-link">PostgreSQL &quot;returning&quot; tricks</a></li><li><a href="/objection.js/recipes/timestamps.html" class="sidebar-link">Timestamps</a></li><li><a href="/objection.js/recipes/custom-query-builder.html" class="sidebar-link">Custom query builder (extending the query builder)</a></li><li><a href="/objection.js/recipes/multitenancy-using-multiple-databases.html" class="sidebar-link">Multitenancy using multiple databases</a></li><li><a href="/objection.js/recipes/default-values.html" class="sidebar-link">Default values</a></li><li><a href="/objection.js/recipes/error-handling.html" class="sidebar-link">Error handling</a></li><li><a href="/objection.js/recipes/ternary-relationships.html" class="sidebar-link">Ternary relationships</a></li><li><a href="/objection.js/recipes/indexing-postgresql-jsonb-columns.html" class="sidebar-link">Indexing PostgreSQL JSONB columns</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="modifiers"><a href="#modifiers" class="header-anchor">#</a> Modifiers</h1> <p>Modifiers allow you to easily reuse snippets of query logic. A modifier is simply a function that takes a <a href="/objection.js/api/query-builder/">QueryBuilder</a> as the first argument and optionally any number of arguments after that. Modifier functions can then mutate the query passed in, but they must always be synchronous. Here's a contrived example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">filterGender</span><span class="token punctuation">(</span><span class="token parameter">query<span class="token punctuation">,</span> gender</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  query<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'gender'</span><span class="token punctuation">,</span> gender<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Model classes have the static <a href="/objection.js/api/model/static-properties.html#static-modifiers">modifiers</a> property that can be used to store these modifiers:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> modifiers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">defaultSelects</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'firstName'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">filterGender</span><span class="token punctuation">(</span><span class="token parameter">query<span class="token punctuation">,</span> gender</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      query<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">'gender'</span><span class="token punctuation">,</span> gender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Modifiers defined in the <a href="/objection.js/api/model/static-properties.html#static-modifiers">modifiers</a> object can then be used in many ways.</p> <h2 id="usage-in-a-query"><a href="#usage-in-a-query" class="header-anchor">#</a> Usage in a query</h2> <p>You can apply any modifier using the <a href="/objection.js/api/query-builder/other-methods.html#modify">modify</a> method:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> women <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modify</span><span class="token punctuation">(</span><span class="token string">'defaultSelects'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modify</span><span class="token punctuation">(</span><span class="token string">'filterGender'</span><span class="token punctuation">,</span> <span class="token string">'female'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="usage-with-eager-loading"><a href="#usage-with-eager-loading" class="header-anchor">#</a> Usage with eager loading</h2> <p>You can pass modifier names as &quot;arguments&quot; to the relation names in <a href="/objection.js/api/types/#type-relationexpression">relation expressions</a>. See the <a href="/objection.js/api/query-builder/eager-methods.html#withgraphfetched">withGraphFetched</a> and <a href="/objection.js/api/query-builder/eager-methods.html#withgraphjoined">withGraphJoined</a> methods' docs for more info and examples.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withGraphFetched</span><span class="token punctuation">(</span>
  <span class="token string">'children(defaultSelects)'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Note that you can only use modifiers registered for the relation's model class. In the previous example <code>children</code> is of class <code>Person</code>, so you can use <code>defaultSelects</code> that was registered for the <code>Person</code> model. In the following example, <code>filterDogs</code> must have been specified in <code>Pet</code> model's <code>modifiers</code> object.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withGraphFetched</span><span class="token punctuation">(</span>
  <span class="token string">'[children(defaultSelects), pets(onlyDogs)]'</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can register new modifiers for a query using the <a href="/objection.js/api/query-builder/other-methods.html#modifiers">modifiers</a> query builder method. This also allows you to bind arguments to existing modifiers like this</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> people <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">withGraphFetched</span><span class="token punctuation">(</span><span class="token string">'children(defaultSelects, filterWomen)'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">modifiers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">filterWomen</span><span class="token operator">:</span> <span class="token parameter">query</span> <span class="token operator">=&gt;</span> query<span class="token punctuation">.</span><span class="token function">modify</span><span class="token punctuation">(</span><span class="token string">'filterGender'</span><span class="token punctuation">,</span> <span class="token string">'female'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="usage-in-joinrelated"><a href="#usage-in-joinrelated" class="header-anchor">#</a> Usage in joinRelated</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> women <span class="token operator">=</span> <span class="token keyword">await</span> Person<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">joinRelated</span><span class="token punctuation">(</span><span class="token string">'children(defaultSelects)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Query builder <a href="/objection.js/api/query-builder/other-methods.html#modifiers">modifiers</a> can also be used with <code>joinRelated</code> just like with <code>withGraphFetched</code> and <code>withGraphJoined</code>.</p> <h2 id="other-usages"><a href="#other-usages" class="header-anchor">#</a> Other usages</h2> <ul><li>Relation mappings' <a href="/objection.js/api/types/#type-relationmapping">modify</a> properties.</li></ul> <h2 id="modifier-best-practices"><a href="#modifier-best-practices" class="header-anchor">#</a> Modifier best practices</h2> <p>You can refer to column names using strings just like we did in the previous example and you won't run into trouble in most cases. In some cases however modifiers may be used in contexts where it's not clear to which table the column names refer and objection doesn't (and in many cases could not) deduce that information from the query. If you want to play it safe, and make the modifiers usable in as many situations as possible, you can use the <a href="/objection.js/api/model/static-methods.html#static-ref">Model.ref</a> helper refer to columns. Like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> modifiers <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">defaultSelects</span><span class="token punctuation">(</span><span class="token parameter">query</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token operator">=</span> Person<span class="token punctuation">;</span>
      query<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'firstName'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">filterGender</span><span class="token punctuation">(</span><span class="token parameter">query<span class="token punctuation">,</span> gender</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token operator">=</span> Person<span class="token punctuation">;</span>
      query<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">'gender'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>When <code>ref</code> is used, the modifiers work even when you have specified an alias for a table in a query.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/objection.js/recipes/joins.html" class="prev">
        Joins
      </a></span> <span class="next"><a href="/objection.js/recipes/composite-keys.html">
        Composite keys
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/objection.js/assets/js/app.d04a8ef7.js" defer></script><script src="/objection.js/assets/js/6.16d8453b.js" defer></script><script src="/objection.js/assets/js/7.4cbcc556.js" defer></script><script src="/objection.js/assets/js/47.6ed9f050.js" defer></script>
  </body>
</html>
